<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini AI Assistant | By Lexxcy</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/tokyo-night-dark.min.css" rel="stylesheet" id="code-theme-dark">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/stackoverflow-light.min.css" rel="stylesheet" id="code-theme-light" disabled>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js">
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js">
</script>


    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap');
        
        :root {
            /* Dark Theme (Default) */
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-gradient: linear-gradient(135deg, #4f46e5, #6366f1);
            --primary-glow: rgba(99, 102, 241, 0.3);
            --background: #0f0f1a;
            --card-bg: #1a1a2e;
            --header-bg: #12121f;
            --input-bg: #14141e;
            --border: #2d2d3d;
            --text: #f3f4f6;
            --text-muted: #9ca3af;
            --success: #10b981;
            --message-user: #4f46e5;
            --message-assistant: #1e1e2e;
        }
        
        :root.light-theme {
            /* Light Theme */
            --primary: #4f46e5;
            --primary-dark: #3730a3;
            --primary-gradient: linear-gradient(135deg, #3730a3, #4f46e5);
            --primary-glow: rgba(79, 70, 229, 0.2);
            --background: #f5f7fa;
            --card-bg: #ffffff;
            --header-bg: #ffffff;
            --input-bg: #f3f4f6;
            --border: #e5e7eb;
            --text: #1f2937;
            --text-muted: #6b7280;
            --success: #059669;
            --message-user: #4f46e5;
            --message-assistant: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.7;
            height: 100vh;
            display: flex;
            flex-direction: column;
            
            margin: 0 auto;
            position: relative;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--background);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        .header {
            background-color: var(--header-bg);
            position: fixed;
            top: 0;
            width: 100%;
            max-width: inherit;
            z-index: 10;
            border-bottom: 1px solid var(--border);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .header-content {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.25rem;
            gap: 1rem;
            justify-content: space-between;
        }

        .profile-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .profile-image {
            width: 42px;
            height: 42px;
            border-radius: 12px;
            background: var(--primary-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: white;
            border: 2px solid var(--border);
            box-shadow: 0 0 15px var(--primary-glow);
            position: relative;
            overflow: hidden;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .profile-image::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 40%, rgba(255, 255, 255, 0.2) 50%, transparent 60%);
            transform: translateX(-100%);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            100% {
                transform: translateX(100%);
            }
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.125rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.3s ease;
        }
        
        .profile-name::after {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
            }
            70% {
                box-shadow: 0 0 0 6px rgba(16, 185, 129, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
            }
        }

        .credit {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-align: center;
            padding: 0.5rem;
            background-color: rgba(18, 18, 31, 0.5);
            border-bottom: 1px solid var(--border);
            letter-spacing: 1px;
            font-weight: 500;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }

        .light-theme .credit {
            background-color: rgba(245, 247, 250, 0.8);
        }

        .theme-toggle {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 9999px;
            padding: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            width: 40px;
            height: 40px;
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.2s ease;
        }

        .theme-toggle:hover {
            transform: translateY(-2px);
        }

        .theme-toggle i {
            font-size: 1.2rem;
            color: var(--text);
            transition: color 0.3s ease;
        }
					.chat-container {
					    flex: 1;
					    overflow-y: auto;
					    padding: 8.5rem 1rem 7rem 1rem;
					    scroll-behavior: smooth;
					    background: radial-gradient(ellipse at top, #14142a, var(--background));
					    transition: margin-left 0.3s ease; /* Transisi halus saat sidebar muncul */
					}
					
@media (min-width: 1024px) {  
    .sidebar {
        width: 200px; /* Lebar diperbesar untuk tampilan lebih nyaman */
        left: 0; /* Sidebar selalu terlihat di PC */
    }

    .chat-container {
        margin-left: 300px; /* Sesuaikan dengan lebar sidebar */
        padding: 2rem;
        height: calc(100vh - 1040px); /* Pastikan area chat tidak terlalu kecil */
    }

    .input-container {
        width: calc(100% - 300px); /* Lebar input menyesuaikan */
        margin-left: 300px;
    }
}



        .light-theme .chat-container {
            background: radial-gradient(ellipse at top, #eef2ff, var(--background));
        }

        .welcome-message {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--text-muted);
            animation: fadeIn 1s ease-out;
            background-color: var(--card-bg);
            padding: 2rem;
            border-radius: 1.5rem;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            max-width: 650px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease, color 0.3s ease;
        }

        .welcome-message h2 {
            margin-bottom: 1rem;
            font-size: 1.5rem;
            font-weight: 600;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .welcome-message p {
            font-size: 13px;
            line-height: 1.7;
        }

        .message {
            max-width: 85%;
            margin: 1rem 0;
            padding: 1.25rem 1.5rem;
            border-radius: 1.25rem;
            box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.1);
            animation: slideIn 0.3s ease-out;
            position: relative;
            word-wrap: break-word;
            transition: transform 0.2s ease-out, background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease, color 0.3s ease;
        }
        
        .message:hover {
            transform: translateY(-2px);
        }

        .message pre {
            background-color: #1a1b26;
            border-radius: 0.75rem;
            padding: 1rem;
            margin: 0.75rem 0;
            overflow-x: auto;
            position: relative;
            border: 1px solid var(--border);
            transition: border-color 0.3s ease;
        }

        .light-theme .message pre {
            background-color: #f9fafb;
        }

        .copy-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(99, 102, 241, 0.2);
            border: none;
            border-radius: 0.3rem;
            padding: 0.3rem 0.6rem;
            color: #fff;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .light-theme .copy-button {
            background: rgba(99, 102, 241, 0.1);
            color: var(--text);
        }

        .copy-button:hover {
            background: rgba(99, 102, 241, 0.4);
            transform: translateY(-2px);
        }

        .light-theme .copy-button:hover {
            background: rgba(99, 102, 241, 0.2);
        }

        .copy-button i {
            font-size: 0.9rem;
        }

        .message code {
            font-family: 'Fira Code', monospace;
            font-size: 0.9em;
        }

        .message strong {
            font-weight: 600;
            color: var(--text);
            transition: color 0.3s ease;
        }
        
        .message a {
            color: var(--primary);
            text-decoration: none;
            border-bottom: 1px dashed var(--primary);
            transition: all 0.2s ease;
        }
        
        .message a:hover {
            border-bottom: 1px solid var(--primary);
            opacity: 0.9;
        }

        .user-message {
            font-size: 12px;
            background: var(--primary-gradient);
            margin-left: auto;
            color: white;
            border-bottom-right-radius: 0.25rem;
            box-shadow: 0 10px 20px -5px var(--primary-glow);
        }

        .assistant-message {
            background-color: var(--message-assistant);
            margin-right: auto;
            color: var(--text);
            border: 1px solid var(--border);
            border-bottom-left-radius: 0.25rem;
        }
        
        .assistant-message::before,
        .user-message::before {
            content: '';
            position: absolute;
            bottom: -0.5rem;
            width: 1.5rem;
            height: 1.5rem;
            clip-path: polygon(0 0, 100% 0, 0 100%);
            transition: background-color 0.3s ease;
        }
        
        .assistant-message::before {
            left: 1rem;
            background-color: var(--message-assistant);
            border-left: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
        }
        
        .user-message::before {
            right: 1rem;
            background: var(--message-user);
            clip-path: polygon(100% 0, 0 0, 100% 100%);
        }

        ./* From Uiverse.io by Nawsome */ 
        /* Typewriter Typing Indicator */
.typing-indicator {
    background-color: var(--message-assistant);
    border-radius: 1.25rem;
    border-bottom-left-radius: 0.25rem;
    margin: 1rem 0;
    max-width: 85%;
    padding: 15px;
    animation: slideIn 0.3s ease-out;
    border: 1px solid var(--border);
    box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.1);
}

.typewriter {
--blue: #2575fc; /* Gradasi ungu ke biru */
--blue-dark:  #4b0082; /* Gradasi ungu gelap */

  --key: #fff;
  --paper: #f3f4f6; /* Warna text muted dari tema Anda */
  --text: #9ca3af; /* Warna text muted dari tema Anda */
  --tool: #fbc56c;
  --duration: 3s;
  position: relative;
  width: 12000px;
  height: 600px;
  margin: 0 auto;
  animation: bounce05 var(--duration) linear infinite;
  size: 15px;
}

.typewriter .slide {
  width: 92px;
  height: 20px;
  border-radius: 3px;
  margin-left: 14px;
  transform: translateX(14px);
  background: linear-gradient(var(--blue), var(--blue-dark));
  animation: slide05 var(--duration) ease infinite;
}



.typewriter .slide:before, .typewriter .slide:after,
.typewriter .slide i:before {
  content: "";
  position: absolute;
  background: var(--tool);
}

.typewriter .slide:before {
  width: 2px;
  height: 8px;
  top: 6px;
  left: 100%;
}

.typewriter .slide:after {
  left: 94px;
  top: 3px;
  height: 14px;
  width: 6px;
  border-radius: 3px;
}

.typewriter .slide i {
  display: block;
  position: absolute;
  right: 100%;
  width: 6px;
  height: 4px;
  top: 4px;
  background: var(--tool);
}

.typewriter .slide i:before {
  right: 100%;
  top: -2px;
  width: 4px;
  border-radius: 2px;
  height: 14px;
}

.typewriter .paper {
  position: absolute;
  left: 24px;
  top: -26px;
  width: 40px;
  height: 46px;
  border-radius: 5px;
  background: var(--paper);
  transform: translateY(46px);
  -webkit-animation: paper05 var(--duration) linear infinite;
  animation: paper05 var(--duration) linear infinite;
}

.typewriter .paper:before {
  content: "";
  position: absolute;
  left: 6px;
  right: 6px;
  top: 7px;
  border-radius: 2px;
  height: 4px;
  transform: scaleY(0.8);
  background: var(--text);
  box-shadow: 0 12px 0 var(--text), 0 24px 0 var(--text), 0 36px 0 var(--text);
}

.typewriter .keyboard {
  width: 120px;
  height: 56px;
  margin-top: -10px;
  z-index: 1;
  position: relative;
}

.typewriter .keyboard:before, .typewriter .keyboard:after {
  content: "";
  position: absolute;
}

.typewriter .keyboard:before {
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 7px;
  background: linear-gradient(135deg, var(--blue), var(--blue-dark));
  transform: perspective(10px) rotateX(2deg);
  transform-origin: 50% 100%;
}

.typewriter .keyboard:after {
  left: 2px;
  top: 25px;
  width: 11px;
  height: 4px;
  border-radius: 2px;
  box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
  -webkit-animation: keyboard05 var(--duration) linear infinite;
  animation: keyboard05 var(--duration) linear infinite;
}

@keyframes bounce05 {
  85%, 92%, 100% {
    transform: translateY(0);
  }

  89% {
    transform: translateY(-4px);
  }

  95% {
    transform: translateY(2px);
  }
}

@keyframes slide05 {
  5% {
    transform: translateX(14px);
  }

  15%, 30% {
    transform: translateX(6px);
  }

  40%, 55% {
    transform: translateX(0);
  }

  65%, 70% {
    transform: translateX(-4px);
  }

  80%, 89% {
    transform: translateX(-12px);
  }

  100% {
    transform: translateX(14px);
  }
}

@keyframes paper05 {
  5% {
    transform: translateY(46px);
  }

  20%, 30% {
    transform: translateY(34px);
  }

  40%, 55% {
    transform: translateY(22px);
  }

  65%, 70% {
    transform: translateY(10px);
  }

  80%, 85% {
    transform: translateY(0);
  }

  92%, 100% {
    transform: translateY(46px);
  }
}

@keyframes keyboard05 {
  5%, 12%, 21%, 30%, 39%, 48%, 57%, 66%, 75%, 84% {
    box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
  }

  9% {
    box-shadow: 15px 2px 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
  }

  18% {
    box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 2px 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
  }

  27% {
    box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 12px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
  }

  36% {
    box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 12px 0 var(--key), 60px 12px 0 var(--key), 68px 12px 0 var(--key), 83px 10px 0 var(--key);
  }

  45% {
    box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 2px 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
  }

  54% {
    box-shadow: 15px 0 0 var(--key), 30px 2px 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
  }

  63% {
    box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 12px 0 var(--key);
  }

  72% {
    box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 2px 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 10px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
  }

  81% {
    box-shadow: 15px 0 0 var(--key), 30px 0 0 var(--key), 45px 0 0 var(--key), 60px 0 0 var(--key), 75px 0 0 var(--key), 90px 0 0 var(--key), 22px 10px 0 var(--key), 37px 12px 0 var(--key), 52px 10px 0 var(--key), 60px 10px 0 var(--key), 68px 10px 0 var(--key), 83px 10px 0 var(--key);
  }
}
.input-container {
    display: flex;
    justify-content: center;
    padding: 20px;
    background: var(--header-bg);
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
    position: fixed;
    bottom: 0;
    width: 100%;
    padding-bottom: 50px; /* Tambahkan ruang ekstra di bawah input */
}

        
        /* Batasi lebar input pada tampilan PC */
        .input-wrapper {
            display: flex;
            gap: 10px;
            width: 100%; /* Lebar penuh pada perangkat kecil */
            max-width: 600px; /* Batasi lebar maksimal pada PC */
            background-color: var(--input-bg);
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 9999px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
					.input-wrapper {
					    display: flex;
					    align-items: center;
					    width: 100%;
					    max-width: 600px;
					    background-color: var(--input-bg);
					    padding: 8px;
					    border: 1px solid var(--border);
					    border-radius: 25px; /* Membuat kotak tumpul */
					    transition: all 0.3s ease;
					    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
					}

        .input-wrapper:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px var(--primary-glow);
        }

        #prompt {	
            flex: 1;
            padding: 0.75rem 1.25rem;
            border-radius: 9999px;
            border: none;
            background-color: transparent;	
            color: var(--text);
            font-size: 1rem;
            outline: none;
            transition: color 0.3s ease;
        }

        #prompt::placeholder {
            color: var(--text-muted);
            transition: color 0.3s ease;
        }

        button {
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 9999px;
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.938rem;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }

        button:hover {
            opacity: 0.95;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(79, 70, 229, 0.4);
        }

        button:active {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(79, 70, 229, 0.4);
        }

        button:disabled {
            background: #374151;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.7;
        }
        
        button i {
            font-size: 1rem;
        }

        .toast {
            position: fixed;
            bottom: 6rem;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            background-color: var(--card-bg);
            color: var(--text);
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-size: 0.9rem;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
            border: 1px solid var(--border);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .toast i {
            color: var(--success);
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateY(15px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(20px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                padding: 0.75rem 1rem;
            }

            .message {
                max-width: 100%;
                margin: 0.75rem 0;
                padding: 1rem 1.25rem;
            }

            button span {
                display: none;
            }

            button {
                padding: 0.75rem;
            }

            .copy-button {
                padding: 0.2rem 0.4rem;
            }

            .copy-button span {
                display: none;
            }
            
            .welcome-message {
                padding: 1.5rem;
            }
            
            .welcome-message h2 {
                font-size: 1.25rem;
            }
        }

					.message-wrapper {
					    position: relative;
					    display: flex;
					    flex-direction: column;
					    align-items: flex-start;
					    padding: 12px 0;
					}
					
					.message {
					    position: relative;
					    padding: 15px;
					    border-radius: 10px;
					    word-wrap: break-word;
					    max-width: 85%;
					}
					
					.user-message {
					    align-self: flex-end;
					    background: var(--primary-gradient);
					    color: white;
					}
					
/* Ukuran font jawaban AI agar lebih konsisten */
.assistant-message {
    font-size: 1rem; /* Sesuaikan ukuran */
    line-height: 1.6; /* Menyesuaikan dengan font lainnya */
    padding: 15px;
    border-radius: 12px;
    white-space: pre-line;
    word-wrap: break-word;
    overflow-wrap: break-word;
}

/* Ukuran font input pengguna agar sejajar dengan jawaban */
#prompt {
    font-size: 1rem; /* Sesuaikan dengan ukuran jawaban */
    line-height: 1.6;
    padding: 10px 15px;
}

					
					/* Geser tombol lebih ke bawah */
					.button-container {
					    display: flex;
					    gap: 10px;
					    margin-top: 8px; /* Jarak lebih jauh dari teks */
					    margin-left: auto; /* Biar tetap di kanan */
					    padding-top: 5px;
					}
					
					.icon-button {
					    background: none;
					    border: none;
					    cursor: pointer;
					    font-size: 10px;
					    color: var(--text-muted);
					    padding: 6px;
					    transition: color 0.2s ease, transform 0.2s ease;
					}
					
					.icon-button:hover {
					    color: var(--primary);
					    transform: scale(1.1);
					}
					
					
					.edit-message {
					    display: flex;
					    flex-direction: column;
					    gap: 8px;
					    padding: 10px;
					    background: var(--input-bg);
					    border: 1px solid var(--border);
					    border-radius: 12px;
					    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
					}
					
					.edit-textarea {
					    width: 100%;
					    padding: 8px;
					    border: none;
					    background: transparent;
					    color: var(--text);
					    font-size: 1rem;
					    outline: none;
					    resize: none;
					}
					
					.edit-buttons {
					    display: flex;
					    gap: 10px;
					    justify-content: flex-end;
					}
					
					.edit-buttons button {
					    background: var(--primary);
					    color: white;
					    border: none;
					    padding: 8px 14px;
					    border-radius: 8px;
					    cursor: pointer;
					    font-size: 0.9rem;
					    transition: 0.3s;
					}
					
					.edit-buttons button:hover {
					    opacity: 0.8;
					}
					@media (min-width: 1024px) {
					    .welcome-message {
					        margin-top: 90px; /* Atur nilai sesuai keinginan */
					    }
					        .chat-container {
					        height: calc(100vh - 120px); /* Sesuaikan dengan tinggi header dan input */
					        padding-bottom: 6rem; /* Sesuaikan agar input terlihat */
					    }
					}
					
					.sidebar {
					    position: fixed;
					    left: -300px; /* Tersembunyi di perangkat mobile */
					    top: 0;
					    width: 250px;
					    height: 100%;
					    background: var(--header-bg);
					    transition: left 0.3s ease;
					    z-index: 1000;
					    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
					    overflow-y: auto;
					}
					
					.sidebar-content {
					    padding: 20px;
					    color: var(--text);
					    font-size: 15px;
					}
					
					.sidebar-content h3 {
					    text-align: center;
					    margin-bottom: 20px;
					    font-weight: 600;
					}
					
					.sidebar-content ul {
					    list-style: none;
					    padding: 0;
					}
					
					.sidebar-content ul li {
					    margin: 10px 0;
					}
					
					.sidebar-content ul li a {
					    color: var(--text);
					    text-decoration: none;
					    display: block;
					    padding: 10px;
					    border-radius: 10px;
					    transition: background 0.3s ease;
					}
					
					.sidebar-content ul li a:hover {
					    background: var(--primary-glow);
					}
					
					.sidebar.show {
					    left: 0; /* Muncul saat digeser ke kanan */
					}
					
					@media (min-width: 1024px) {
					    .sidebar {
					        left: 0; /* Selalu tampil di PC */
					    }
					}
					
					.theme-toggle-container {
					    position: absolute;
					    bottom: 20px; /* Jarak dari bawah */
					    left: 50%;
					    transform: translateX(-50%);
					    width: 80%;
					    text-align: center;
					}
					
					.theme-toggle {
					    background: var(--primary-gradient);
					    color: white;
					    border: none;
					    padding: 10px 20px;
					    border-radius: 8px;
					    cursor: pointer;
					    font-size: 1rem;
					    display: flex;
					    align-items: center;
					    justify-content: center;
					    width: 100%;
					    gap: 10px;
					    transition: background 0.3s ease, transform 0.2s ease;
					}
					
					.theme-toggle:hover {
					    transform: scale(1.05);
					}
					
					.theme-toggle i {
					    font-size: 1.2rem;
					}
					@media (min-width: 1024px) {
					    .header-content {
					        display: flex;
					        align-items: center;
					        padding: 0.75rem 1.25rem;
					    }
					
					    .profile-container {
					        display: flex;
					        align-items: center;
					        gap: 10px;
					        flex: 1;
					        margin-left: 300px; /* Menyesuaikan dengan lebar sidebar */
					    }
					}
/* ===================== LAYOUT STYLES ===================== */
/* Desktop layout */
@media (min-width: 1024px) {
    .input-container {
        width: calc(100% - 300px);
        margin-left: 250px;
        position: fixed;
        bottom: 0;
        display: flex;
        justify-content: center;
        padding: 20px;
        background: var(--header-bg);
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        right: -0px;
    }

    .input-wrapper {
        width: 100%;
        max-width: 100%;
        background-color: var(--input-bg);
        padding: 10px;
        border: 1px solid var(--border);
        border-radius: 25px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .sidebar {
        left: 0; /* Always visible on PC */
    }
}


/* ===================== SPINNER STYLES ===================== */
.spinner-container {
    position: absolute;
    top: 50%;
    right: 15px; /* Default position for small screens */
    transform: translateY(-50%);
}

/* Adjust position on larger screens */
@media (min-width: 1024px) {
    .spinner-container {
        right: 50px;
    }
}

.spinner {
    width: 1.8em;
    height: 1.8em;
    border-radius: 50%;
    border: 2px solid var(--border);
    box-shadow: -6px -6px 6px var(--primary), 
                0px -6px 6px var(--primary-dark), 
                6px -6px 6px var(--success), 
                6px 0px 6px #ff0b0b, 
                6px 6px 6px #ff5500, 
                0px 6px 6px #ff9500, 
                -6px 6px 6px #ffb700;
    animation: spin 2.5s linear infinite;
}

.spinnerin {
    border: 2px solid var(--border);
    width: 0.9em;
    height: 0.9em;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: var(--card-bg);
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* ===================== QUESTION SUGGESTION STYLES ===================== */
.question-suggestions {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 10px;
    padding: 10px;
}

.question-suggestions button {
    background: var(--primary-gradient);
    color: white;
    border: none;
    padding: 8px 14px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.7rem;
    transition: 0.3s;
}

.question-suggestions button:hover {
    opacity: 0.8;
}

/* ===================== IMAGE UPLOAD & CAMERA STYLES ===================== */
.image-upload-btn, .camera-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px;
    background: none;
    border: none;
    color: #666;
    font-size: 1.2rem;
    cursor: pointer;
    margin-right: 5px;
    border-radius: 50%;
    transition: background-color 0.3s, color 0.3s;
}

.image-upload-btn:hover, .camera-btn:hover {
    background-color: #f0f0f0;
    color: #333;
}
/* Processing Indicator Style */
.processing-indicator {
    background-color: var(--primary-glow);
    color: var(--primary);
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 0.8rem;
    margin-top: 8px;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% { opacity: 0.6; }
    50% { opacity: 1; }
    100% { opacity: 0.6; }
}
.uploaded-image {
    max-width: 100%;
    max-height: 300px;
    border-radius: 8px;
    margin: 5px 0;
}

/* Camera modal */
.camera-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.camera-modal video {
    max-width: 90%;
    max-height: 70vh;
    background-color: #000;
}

.camera-modal button {
    margin: 10px;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
}

.capture-btn {
    background-color: #4CAF50;
    color: white;
}

.close-btn {
    background-color: #f44336;
    color: white;
}

/* ===================== TOAST NOTIFICATION STYLES ===================== */
.toast {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 12px 20px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 1000;
    opacity: 0;
    transition: all 0.3s ease;
}

.toast.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
}

/* ===================== LANGUAGE SPECIFIC STYLES ===================== */
body.id-lang .message {
    font-family: 'Roboto', 'Noto Sans', sans-serif;
    line-height: 1.5;
}

body.id-lang .welcome-message h2 {
    color: #2c3e50;
}

body.id-lang .user-input::placeholder {
    font-style: italic;
    font-size: 10px;
}

/* ===================== DRAG AND DROP STYLES ===================== */
body.dragging {
    background-color: rgba(99, 102, 241, 0.1);
    transition: background-color 0.3s ease;
}

/* ===================== ASSISTANT MESSAGE STYLES ===================== */
.assistant-message {
    background-color: var(--message-assistant);
    color: var(--text);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 15px;
    line-height: 1.3;
    font-size: 0.7rem;
    white-space: pre-line;
    word-wrap: break-word;
    overflow-wrap: break-word;
    max-width: 85%;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

/* Paragraph spacing */
.assistant-message p {
    margin-bottom: 1px;
}

/* List styling */
.assistant-message ul,
.assistant-message ol {
    padding-left: 20px;
    margin-bottom: 10px;
}

.assistant-message ul li,
.assistant-message ol li {
    margin-bottom: 5px;
}

/* Heading styles */
.assistant-message h1, 
.assistant-message h2, 
.assistant-message h3 {
    margin-bottom: 10px;
    font-weight: 600;
}

/* Blockquote styles */
.assistant-message blockquote {
    margin-left: 12px;
    padding-left: 8px;
    border-left: 3px solid var(--primary);
    font-style: italic;
    color: var(--text-muted);
}

/* Code block styles */
.assistant-message pre {
    background-color: #1a1b26;
    border-radius: 6px;
    padding: 12px;
    overflow-x: auto;
    border: 1px solid var(--border);
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    margin-top: 8px;
    margin-bottom: 8px;
}

/* ===================== TABLE STYLES ===================== */
.table-container {
    width: 100%;
    overflow-x: auto;
    margin-top: 10px;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.ai-table {
    width: 100%;
    min-width: 600px;
    border-collapse: collapse;
    font-size: 16px;
    background-color: var(--card-bg);
    border: 1px solid var(--border);
}

.ai-table thead tr {
    background: var(--primary-gradient);
    color: white;
    text-align: left;
    font-weight: bold;
}

.ai-table th, .ai-table td {
    padding: 12px 15px;
    border-bottom: 1px solid var(--border);
    white-space: nowrap;
}

.ai-table tbody tr:nth-child(even) {
    background-color: var(--input-bg);
}

.ai-table tbody tr:hover {
    background-color: var(--primary-glow);
    transition: background 0.3s ease;
}

/* ===================== CHAT HISTORY STYLES ===================== */
.chat-history {
    margin-top: 20px;
}

/* ===================== SIDEBAR STYLES ===================== */
.sidebar {
    position: fixed;
    left: -300px;
    top: 0;
    width: 300px;
    height: 100%;
    background: var(--card-bg);
    transition: left 0.3s ease-in-out;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    padding: 15px;
    overflow-y: auto;
}

.sidebar.show {
    left: 0;
}

/* ===================== BUTTON STYLES ===================== */
/* New Chat Button */
#new-chat-btn {
    width: auto;
    padding: 10px 16px;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.6rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: background 0.3s ease, transform 0.2s ease-in-out;
    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
}

#new-chat-btn i {
    font-size: 1rem;
}

#new-chat-btn:hover {
    background: var(--primary-dark);
    transform: scale(1.03);
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.4);
}

#new-chat-btn:active {
    transform: scale(0.98);
    box-shadow: 0 1px 6px rgba(79, 70, 229, 0.4);
}

/* Clear Chat Button */
#clear-chat-btn {
    padding: 10px 16px;
    background: #ff4d4d;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.6rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: background 0.3s ease, transform 0.2s ease-in-out;
    box-shadow: 0 2px 8px rgba(255, 77, 77, 0.3);
}

#clear-chat-btn i {
    font-size: 1rem;
}

#clear-chat-btn:hover {
    background: #e60000;
    transform: scale(1.03);
    box-shadow: 0 4px 12px rgba(255, 77, 77, 0.4);
}

#clear-chat-btn:active {
    transform: scale(0.98);
    box-shadow: 0 1px 6px rgba(255, 77, 77, 0.4);
}

.

/* ===================== CHAT LIST STYLES ===================== */
#chat-list {
    list-style: none;
    padding: 0;
    margin-top: 10px;
}

#chat-list li {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s ease;
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text);
    position: relative;
    background: var(--input-bg);
    border: 1px solid var(--border);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

#chat-list li:hover {
    background: var(--primary-glow);
    transform: scale(1.02);
}

#chat-list li.active {
    background: var(--primary-dark);
    color: white;
}

/* Chat Icon */
.chat-icon {
    background: var(--primary);
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    color: white;
    font-size: 0.85rem;
}

/* Delete Chat Button */
.delete-chat {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1rem;
    color: #ff4d4d;
    padding: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background 0.2s ease, transform 0.2s ease, color 0.2s ease;
}

.delete-chat i {
    font-size: 1.2rem;
}

.delete-chat:hover {
    background: rgba(255, 77, 77, 0.1);
    color: #e60000;
    transform: scale(1.2);
}

.delete-chat:active {
    transform: scale(0.95);
}

/* ===================== MODAL STYLES ===================== */
/* ===================== LAYOUT STYLES ===================== */
/* Desktop layout */
@media (min-width: 1024px) {
    .input-container {
        width: calc(100% - 300px);
        margin-left: 250px;
        position: fixed;
        bottom: 0;
        display: flex;
        justify-content: center;
        padding: 20px;
        background: var(--header-bg);
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        right: -0px;
        padding-bottom: 60px; 
    }

    .input-wrapper {
        width: 95%;
        max-width: 100%;
        background-color: var(--input-bg);
        padding: 10px;
        border: 1px solid var(--border);
        border-radius: 25px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .sidebar {
        left: 0; /* Always visible on PC */
    }
}

/* ===================== SPINNER STYLES ===================== */
.spinner-container {
    position: absolute;
    top: 50%;
    right: 15px; /* Default position for small screens */
    transform: translateY(-50%);
}

/* Adjust position on larger screens */
@media (min-width: 1024px) {
    .spinner-container {
        right: 50px;
    }
}

.spinner {
    width: 1.8em;
    height: 1.8em;
    border-radius: 50%;
    border: 2px solid var(--border);
    box-shadow: -6px -6px 6px var(--primary), 
                0px -6px 6px var(--primary-dark), 
                6px -6px 6px var(--success), 
                6px 0px 6px #ff0b0b, 
                6px 6px 6px #ff5500, 
                0px 6px 6px #ff9500, 
                -6px 6px 6px #ffb700;
    animation: spin 2.5s linear infinite;
}

.spinnerin {
    border: 2px solid var(--border);
    width: 0.9em;
    height: 0.9em;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: var(--card-bg);
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* ===================== QUESTION SUGGESTION STYLES ===================== */
.question-suggestions {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 10px;
    padding: 10px;
}

.question-suggestions button {
    background: var(--primary-gradient);
    color: white;
    border: none;
    padding: 8px 14px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.7rem;
    transition: 0.3s;
}

.question-suggestions button:hover {
    opacity: 0.8;
}

/* ===================== IMAGE UPLOAD & CAMERA STYLES ===================== */
.image-upload-btn, .camera-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px;
    background: none;
    border: none;
    color: #666;
    font-size: 1.2rem;
    cursor: pointer;
    margin-right: 5px;
    border-radius: 50%;
    transition: background-color 0.3s, color 0.3s;
}

.image-upload-btn:hover, .camera-btn:hover {
    background-color: #f0f0f0;
    color: #333;
}

.uploaded-image {
    max-width: 100%;
    max-height: 300px;
    border-radius: 8px;
    margin: 5px 0;
}

/* Camera modal */
.camera-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.camera-modal video {
    max-width: 90%;
    max-height: 70vh;
    background-color: #000;
}

.camera-modal button {
    margin: 10px;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
}

.capture-btn {
    background-color: #4CAF50;
    color: white;
}

.close-btn {
    background-color: #f44336;
    color: white;
}

/* ===================== TOAST NOTIFICATION STYLES ===================== */
.toast {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 12px 20px;
    border-radius: 4px;
    font-size: 14px;
    z-index: 1000;
    opacity: 0;
    transition: all 0.3s ease;
}

.toast.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
}

/* ===================== LANGUAGE SPECIFIC STYLES ===================== */
body.id-lang .message {
    font-family: 'Roboto', 'Noto Sans', sans-serif;
    line-height: 1.5;
}

body.id-lang .welcome-message h2 {
    color: #2c3e50;
}

body.id-lang .user-input::placeholder {
    font-style: italic;
    font-size: 10px;
}

/* ===================== DRAG AND DROP STYLES ===================== */
body.dragging {
    background-color: rgba(99, 102, 241, 0.1);
    transition: background-color 0.3s ease;
}

/* ===================== ASSISTANT MESSAGE STYLES ===================== */
.assistant-message {
    background-color: var(--message-assistant);
    color: var(--text);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 15px;
    line-height: 1.3;
    font-size: 0.7rem;
    white-space: pre-line;
    word-wrap: break-word;
    overflow-wrap: break-word;
    max-width: 85%;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

/* Paragraph spacing */
.assistant-message p {
    margin-bottom: 1px;
}

/* List styling */
.assistant-message ul,
.assistant-message ol {
    padding-left: 20px;
    margin-bottom: 10px;
}

.assistant-message ul li,
.assistant-message ol li {
    margin-bottom: 5px;
}

/* Heading styles */
.assistant-message h1, 
.assistant-message h2, 
.assistant-message h3 {
    margin-bottom: 10px;
    font-weight: 600;
}

/* Blockquote styles */
.assistant-message blockquote {
    margin-left: 12px;
    padding-left: 8px;
    border-left: 3px solid var(--primary);
    font-style: italic;
    color: var(--text-muted);
}

/* Code block styles */
.assistant-message pre {
    background-color: #1a1b26;
    border-radius: 6px;
    padding: 12px;
    overflow-x: auto;
    border: 1px solid var(--border);
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    margin-top: 8px;
    margin-bottom: 8px;
}

/* ===================== TABLE STYLES ===================== */
.table-container {
    width: 100%;
    overflow-x: auto;
    margin-top: 10px;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.ai-table {
    width: 100%;
    min-width: 600px;
    border-collapse: collapse;
    font-size: 16px;
    background-color: var(--card-bg);
    border: 1px solid var(--border);
}

.ai-table thead tr {
    background: var(--primary-gradient);
    color: white;
    text-align: left;
    font-weight: bold;
}

.ai-table th, .ai-table td {
    padding: 12px 15px;
    border-bottom: 1px solid var(--border);
    white-space: nowrap;
}

.ai-table tbody tr:nth-child(even) {
    background-color: var(--input-bg);
}

.ai-table tbody tr:hover {
    background-color: var(--primary-glow);
    transition: background 0.3s ease;
}

/* ===================== CHAT HISTORY STYLES ===================== */
.chat-history {
    margin-top: 20px;
}

/* ===================== SIDEBAR STYLES ===================== */
.sidebar {
    position: fixed;
    left: -300px;
    top: 0;
    width: 300px;
    height: 100%;
    background: var(--card-bg);
    transition: left 0.3s ease-in-out;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    padding: 15px;
    overflow-y: auto;
}

.sidebar.show {
    left: 0;
}

/* ===================== BUTTON STYLES ===================== */
/* New Chat Button */
#new-chat-btn {
    width: auto;
    padding: 10px 16px;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.6rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: background 0.3s ease, transform 0.2s ease-in-out;
    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
}

#new-chat-btn i {
    font-size: 1rem;
}

#new-chat-btn:hover {
    background: var(--primary-dark);
    transform: scale(1.03);
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.4);
}

#new-chat-btn:active {
    transform: scale(0.98);
    box-shadow: 0 1px 6px rgba(79, 70, 229, 0.4);
}

/* Clear Chat Button */
#clear-chat-btn {
    padding: 10px 16px;
    background: #ff4d4d;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.6rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: background 0.3s ease, transform 0.2s ease-in-out;
    box-shadow: 0 2px 8px rgba(255, 77, 77, 0.3);
}

#clear-chat-btn i {
    font-size: 1rem;
}

#clear-chat-btn:hover {
    background: #e60000;
    transform: scale(1.03);
    box-shadow: 0 4px 12px rgba(255, 77, 77, 0.4);
}

#clear-chat-btn:active {
    transform: scale(0.98);
    box-shadow: 0 1px 6px rgba(255, 77, 77, 0.4);
}

/* ===================== CHAT LIST STYLES ===================== */
#chat-list {
    list-style: none;
    padding: 0;
    margin-top: 10px;
}

#chat-list li {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s ease;
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text);
    position: relative;
    background: var(--input-bg);
    border: 1px solid var(--border);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

#chat-list li:hover {
    background: var(--primary-glow);
    transform: scale(1.02);
}

#chat-list li.active {
    background: var(--primary-dark);
    color: white;
}

/* Chat Icon */
.chat-icon {
    background: var(--primary);
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    color: white;
    font-size: 0.85rem;
}

/* Delete Chat Button */
.delete-chat {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1rem;
    color: #ff4d4d;
    padding: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background 0.2s ease, transform 0.2s ease, color 0.2s ease;
}

.delete-chat i {
    font-size: 1.2rem;
}

.delete-chat:hover {
    background: rgba(255, 77, 77, 0.1);
    color: #e60000;
    transform: scale(1.2);
}

.delete-chat:active {
    transform: scale(0.95);
}

/* ===================== MODAL STYLES ===================== */
.modal {
    display: none;
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%) scale(0.8);
    background: var(--card-bg);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    text-align: center;
    z-index: 1000;
    transition: transform 0.2s ease-in-out, opacity 0.2s ease-in-out;
}

.modal.show {
    display: block;
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
}

.modal-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
}

.modal-buttons button {
    padding: 10px 14px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
}

#confirm-delete {
    background: red;
    color: white;
}

#cancel-delete {
    background: var(--primary-dark);
    color: white;
}

/* Delete Button */
.delete-btn {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 12px;
    color: red;
    padding: 6px;
    transition: color 0.2s ease, transform 0.2s ease;
}

.delete-btn:hover {
    color: darkred;
    transform: scale(1.1);
}

/* ===================== ANIMATION STYLES ===================== */
/* Fade Out Animation */
@keyframes fadeOut {
    from {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
    to {
        opacity: 0;
        transform: translateY(-10px) scale(0.9);
    }
}

/* Fade In Animation */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px) scale(0.9);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* Element transition effects */
.fade-in {
    animation: fadeIn 0.3s ease-out;
}

.fade-out {
    animation: fadeOut 0.3s ease-in;
}
/* Overlay Latar Belakang Modal */
.modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6); /* Latar belakang hitam transparan */
    z-index: 999; /* Di bawah modal */
    backdrop-filter: blur(5px); /* Efek blur */
}

/* Modal */
.modal {
    display: none;
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%) scale(0.9);
    background: var(--card-bg);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    text-align: center;
    z-index: 1000; /* Di atas overlay */
    transition: transform 0.2s ease-out, opacity 0.2s ease-out;
    max-width: 350px;
    width: 90%;
}

.modal.show,
.modal-overlay.show {
    display: block;
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
}

/* Gaya Modal */
.modal h3 {
    color: var(--text);
    font-size: 1.25rem;
    margin-bottom: 10px;
}

.modal p {
    color: var(--text-muted);
    font-size: 0.95rem;
    margin-bottom: 20px;
}

.modal-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
}

.modal-buttons button {
    padding: 10px 14px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-weight: 500;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s ease;
}

/* Tombol Hapus */
.danger-btn {
    background: #ff4d4d;
    color: white;
}

.danger-btn:hover {
    background: #e60000;
    transform: scale(1.05);
}

/* Tombol Batal */
.cancel-btn {
    background: var(--primary-dark);
    color: white;
}

.cancel-btn:hover {
    background: var(--primary);
    transform: scale(1.05);
}
@media (min-width: 1024px) {  
    .sidebar {
        left: 0; /* Sidebar selalu terlihat di PC */
    }



    .input-container {
        width: calc(100% - 300px); /* Lebar input menyesuaikan */
        margin-left: 300px;
    }
}

.chat-timestamp {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 4px;
    text-align: left;
}

/* Tambahkan di bagian CSS */
#no-chat-message {
    text-align: center;
    color: var(--text-muted);
    font-size: 0.9rem;
    padding: 1rem;
    border: 1px dashed var(--border);
    border-radius: 8px;
    margin: 1rem;
    background-color: var(--input-bg);
}
.new-chat-container {
    display: flex;
    right: -40px;
    position: fixed;
    bottom: 10px; /* Beri jarak di atas input-container */
    width: 100%;
    z-index: 1000;
}

#new-chat-btn {
    padding: 10px 16px;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: background 0.3s ease, transform 0.2s ease-in-out;
    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
}
#new-chat-container {

    z-index: 900; /* Pastikan tombol ada di belakang menu */
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

.sidebar.show ~ #new-chat-container {
    opacity: 0;
    visibility: hidden;
}


#new-chat-btn:hover {
    background: var(--primary-dark);
    transform: scale(1.05);
}
.menu-button {
    width: 50px;
    height: 50px;
    background: none;
    color: var(--primary);
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 4rem;
    cursor: pointer;
    transition: color 0.3s ease-in-out;
    position: sticky;
    bottom: 800px; /* Ubah sesuai kebutuhan */
    margin-right: 10%;
    z-index: 1000;
    box-shadow: none; /* Menghilangkan bayangan */
    
}

.menu-button:hover {
    color: var(--primary-dark);
}

.menu-button i {
    font-size: 30px; /* Pastikan ikon mengikuti ukuran tombol */
}

/* Setelah diklik (di samping sidebar) */
.menu-button.active {
    right: 260px; /* Sesuaikan dengan lebar sidebar */
    bottom: 50px;
    transform: scale(1.1); /* Efek sedikit membesar */
    background: var(--primary-dark); /* Warna berubah */
}
@media (min-width: 1024px) {
    #menu-button {
        display: none;
    }
}
@media (min-width: 1024px) {
    #new-chat-container {
        display: flex !important;
        position: fixed;
        bottom: 20px;
        right: -385px; /* Sesuaikan posisi sesuai keinginan */
        z-index: 1000;
        opacity: 1;
        visibility: visible;
    }
}
/* ======= Peningkatan Tampilan Riwayat Chat ======= */
#chat-list {
    max-height: 60vh;
    overflow-y: auto;
    padding-right: 8px;
    margin-top: 10px;
}

#chat-list li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    margin-bottom: 8px;
    border-radius: 10px;
    background: var(--input-bg);
    border: 1px solid var(--border);
    cursor: pointer;
    transition: all 0.3s ease;
}

#chat-list li:hover {
    background: var(--primary-glow);
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

#chat-list li.active {
    background: var(--primary-gradient);
    color: white;
    border-color: var(--primary-dark);
}

/* Kontainer judul dan waktu */
.chat-title-wrapper {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-width: 0;
}

.chat-title {
    font-weight: 500;
    font-size: 0.85rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.chat-time {
    font-size: 0.7rem;
    color: var(--text-muted);
    margin-top: 2px;
}

/* Light theme adjustment */
.light-theme #chat-list li .chat-time {
    color: rgba(0, 0, 0, 0.6);
}

/* Gaya untuk tombol delete */
.delete-chat {
    background: rgba(255, 77, 77, 0.1);
    border: none;
    border-radius: 50%;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    color: #ff4d4d;
    opacity: 1; /* Selalu terlihat */
    margin-left: 8px;
    flex-shrink: 0;
}

.delete-chat i {
    font-size: 0.8rem;
}

/* Hover state */
.delete-chat:hover {
    background: rgba(255, 77, 77, 0.2);
    color: #e60000;
    transform: scale(1.05);
}

/* Active state */
.delete-chat:active {
    transform: scale(0.95);
}

/* Untuk chat yang aktif */
#chat-list li.active .delete-chat {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

#chat-list li.active .delete-chat:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Efek animasi saat chat baru muncul */
@keyframes fadeInNewChat {
    from {
        opacity: 0;
        transform: translateY(-5px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Chat baru ditambahkan - Efek Highlight */
.new-chat {
    animation: fadeInNewChat 0.5s ease-in-out;
    background: rgba(99, 102, 241, 0.15) !important;
    border-left: 3px solid var(--primary);
}

/* Indikator "Chat Baru Ditambahkan" */
#new-chat-indicator {
    text-align: center;
    background: var(--primary);
    color: white;
    font-size: 0.85rem;
    padding: 8px;
    border-radius: 6px;
    margin-bottom: 10px;
    display: none;
    transition: opacity 0.3s ease-in-out;
}

#no-chat-message {
    text-align: center;
    color: var(--text-muted);
    font-size: 0.9rem;
    padding: 1rem;
    border: 1px dashed var(--border);
    border-radius: 8px;
    margin: 1rem;
    background-color: var(--input-bg);
    display: none; /* Awalnya disembunyikan */
}

#chat-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

#chat-list li {
    padding: 10px;
    margin: 5px 0;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s;
}

#chat-list li:hover {
    background-color: var(--primary-glow);
}
/* Image Upload & Camera Styles */
.image-upload-btn, .camera-btn {
    background: var(--primary-gradient);
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.2s, opacity 0.2s;
}

.image-upload-btn:hover, .camera-btn:hover {
    transform: scale(1.1);
    opacity: 0.9;
}

.image-upload-btn i, .camera-btn i {
    font-size: 1.2rem;
}

.uploaded-image {
    max-width: 100%;
    max-height: 300px;
    border-radius: 12px;
    object-fit: contain;
    margin-bottom: 10px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border: 1px solid var(--border);
}

.message-confirmation {
    margin-top: 10px;
    width: 100%;
}

.command-input {
    width: 100%;
    padding: 10px;
    border-radius: 12px;
    border: 1px solid var(--border);
    background-color: var(--input-bg);
    color: var(--text);
    font-size: 0.9rem;
    resize: none;
    margin-bottom: 8px;
}

.command-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 2px var(--primary-glow);
}

.confirmation-buttons {
    display: flex;
    gap: 8px;
    width: 100%;
}

.confirm-send-btn {
    background: var(--primary-gradient);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: opacity 0.2s;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
}

.confirm-send-btn:hover {
    opacity: 0.9;
}

.cancel-send-btn {
    background: var(--card-bg);
    color: var(--text);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: background-color 0.2s;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
}

.cancel-send-btn:hover {
    background-color: var(--input-bg);
}

/* Camera Modal Styles */
.camera-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 20px;
    box-sizing: border-box;
}

.capture-btn {
    background: var(--success);
    color: white;
}

.switch-btn {
    background: var(--primary);
    color: white;
}

.close-btn {
    background: #f44336;
    color: white;
}

.camera-modal button {
    border: none;
    border-radius: 8px;
    padding: 10px 15px;
    cursor: pointer;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: opacity 0.2s;
}

.camera-modal button:hover {
    opacity: 0.9;
}
/* Camera Modal Styles */
.camera-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    display: none;
    justify-content: center;
    align-items: center;
}

.camera-modal-content {
    position: relative;
    width: 100%;
    max-width: 500px;
    height: 80vh;
    display: flex;
    flex-direction: column;
}

.camera-video, .camera-canvas {
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: #000;
    border-radius: 8px;
}

.camera-controls {
    position: absolute;
    bottom: 20px;
    left: 0;
    right: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 40px;
    padding: 0 20px;
}

.camera-capture-btn {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: white;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.3);
    transition: all 0.2s;
}

.camera-capture-btn i {
    color: #333;
    font-size: 24px;
}

.camera-capture-btn:hover {
    transform: scale(1.05);
}

.camera-close-btn, .camera-switch-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 20px;
    transition: all 0.2s;
}

.camera-close-btn:hover, .camera-switch-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

/* Styles untuk preview gambar setelah diambil */
.uploaded-image {
    max-width: 100%;
    max-height: 300px;
    border-radius: 12px;
    object-fit: contain;
    margin-bottom: 8px;
}

.message-confirmation {
    margin-top: 10px;
    width: 100%;
}

.command-input {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background-color: var(--input-bg);
    color: var(--text);
    font-size: 0.9rem;
    resize: none;
    margin-bottom: 8px;
}

.confirmation-buttons {
    display: flex;
    gap: 8px;
}

.confirm-send-btn {
    background: var(--primary-gradient);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 0.9rem;
    flex: 1;
}

.cancel-send-btn {
    background: var(--card-bg);
    color: var(--text);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 0.9rem;
    flex: 1;
}
.camera-modal button i {
    font-size: 1rem;
}
/* Konsistensi tampilan untuk upload dan kamera */
.uploaded-image {
    max-width: 100%;
    max-height: 300px;
    border-radius: 12px;
    object-fit: contain;
    margin-bottom: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border: 1px solid var(--border);
}

.message-confirmation {
    margin-top: 10px;
    width: 100%;
}

.command-input {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background-color: var(--input-bg);
    color: var(--text);
    font-size: 0.9rem;
    resize: none;
    margin-bottom: 8px;
}

.confirmation-buttons {
    display: flex;
    gap: 8px;
}

.confirm-send-btn {
    background: var(--primary-gradient);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 0.9rem;
    flex: 1;
    transition: opacity 0.2s;
}

.cancel-send-btn {
    background: var(--card-bg);
    color: var(--text);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 0.9rem;
    flex: 1;
    transition: background-color 0.2s;
}

.image-command-text {
    margin-top: 8px;
    padding: 8px 12px;
    background: var(--input-bg);
    border-radius: 8px;
    font-size: 0.8rem;
    color: var(--text-muted);
    border-left: 3px solid var(--primary);
}

/* Camera specific styles */
.camera-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    display: none;
    justify-content: center;
    align-items: center;
}

.camera-video, .camera-canvas {
    max-width: 90vw;
    max-height: 80vh;
    background: #000;
}
    </style>
</head>
<body>
    <div class="header">
<div class="header-content">
    <div class="profile-container">
        <div class="profile-image">
            <i class="fas fa-robot"></i>
        </div>
        <div class="profile-info">
            <div class="profile-name">Lexccy AI Assistant</div>
        </div>
        <button id="menu-button" class="menu-button">
    <i class="fa-solid fa-clock-rotate-left"></i>
</button>
    </div>

    <!-- Spinner di pojok kanan atas -->
    <div class="spinner-container">
        <div class="spinner">
            <div class="spinnerin"></div>
        </div>
    </div>
</div>
</div>
<div class="sidebar" id="sidebar">
    <div class="sidebar-content">
        <h3>Menu</h3>
        <ul>
            <li><a href="#"><i class="fa-solid fa-house"></i> Home</a></li>
            <li><a href="#"><i class="fa-solid fa-circle-info"></i> About</a></li>
            <li><a href="#"><i class="fa-solid fa-cogs"></i> Services</a></li>
            <li><a href="#"><i class="fa-solid fa-envelope"></i> Contact</a></li>
        </ul>
        
        <h3>Riwayat Chat</h3>
        <div class="chat-buttons">
            <p id="no-chat-message">Tidak ada riwayat chat</p>

</div>


        <ul id="chat-list">
            <li>
                <span class="chat-name">Chat 1</span>
                <button class="delete-chat">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </li>
            <li>
                <span class="chat-name">Chat 2</span>
                <button class="delete-chat">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </li>
        </ul>
    </div>
    
    <!-- Toggle Tema -->
    <div class="theme-toggle-container">
        <button class="theme-toggle" id="theme-toggle">
            <i class="fa-solid fa-moon"></i> <span>Dark Mode</span>
        </button>
    </div>
</div>

<!-- Modal Konfirmasi Hapus -->
<div id="delete-modal" class="modal">
    <div class="modal-content">
        <h3>Konfirmasi Hapus</h3>
        <p>Apakah Anda yakin ingin menghapus chat ini?</p>
        <div class="modal-buttons">
            <button id="confirm-delete">Hapus</button>
            <button id="cancel-delete">Batal</button>
        </div>
    </div>
</div>


    <div class="chat-container" id="chat-container">
        <div class="welcome-message">
            <h2>Welcome to Lexxcy AI Assistant!</h2>
            <p>I'm here to help with information, answer questions, generate creative content, and assist with various tasks. Just type your message below to get started!</p>
        </div>
        <div class="question-suggestions" id="question-suggestions">
    <button onclick="fillAndSend('Apa itu AI?')">Apa itu AI?</button>
    <button onclick="fillAndSend('Bagaimana cara kerja AI?')">Bagaimana cara kerja AI?</button>
    <button onclick="fillAndSend('Apa manfaat AI dalam kehidupan sehari-hari?')">Apa manfaat AI dalam kehidupan sehari-hari?</button>
    <button onclick="fillAndSend('Bagaimana AI belajar dari data?')">Bagaimana AI belajar dari data?</button>
</div>
    </div>

    <div class="toast" id="toast"><i class="fas fa-check-circle"></i> Copied to clipboard!</div><div id="new-chat-container" class="new-chat-container">
    <button id="new-chat-btn"><i class="fa-regular fa-comment-dots"></i> New Chat</button>
</div>

<div class="input-container">
    <div class="input-wrapper">
        <textarea 
            id="prompt" 
            placeholder="Ada pertanyaan ..." 
            rows="1"
            style="resize: none; overflow: hidden;"
            oninput="autoResize(this)"
        ></textarea>
        <button onclick="generateContent()" id="submit-btn">
            <i class="fas fa-paper-plane"></i>
            <span>Send</span>
        </button>
    </div>
</div>



    <script>
      marked.setOptions({
    highlight: function(code, lang) {
        if (lang && hljs.getLanguage(lang)) {
            return hljs.highlight(code, { language: lang }).value;
        }
        return hljs.highlightAuto(code).value;
    },
    breaks: true
});

let isGenerating = false;
const API_KEY = "AIzaSyBeCuV1Xi2MGYBA_waHBB5RLj_utna_Mio"; // Your API Key

// Store conversation history for multi-turn functionality
let conversationHistory = [];
let currentlyEditing = null;

// Theme toggling functionality
const themeToggle = document.getElementById('theme-toggle');
const rootElement = document.documentElement;
const darkThemeIcon = '<i class="fas fa-moon"></i>';
const lightThemeIcon = '<i class="fas fa-sun"></i>';
const codeThemeDark = document.getElementById('code-theme-dark');
const codeThemeLight = document.getElementById('code-theme-light');

// Check for saved theme preference or use preferred color scheme
const savedTheme = localStorage.getItem('theme');
if (savedTheme === 'light') {
    enableLightTheme();
} else if (savedTheme === 'dark') {
    enableDarkTheme();
} else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
    enableLightTheme();
}

// Theme toggle event listener
themeToggle.addEventListener('click', () => {
    if (rootElement.classList.contains('light-theme')) {
        enableDarkTheme();
    } else {
        enableLightTheme();
    }
});

function enableLightTheme() {
    rootElement.classList.add('light-theme');
    themeToggle.innerHTML = darkThemeIcon;
    if (codeThemeDark) codeThemeDark.disabled = true;
    if (codeThemeLight) codeThemeLight.disabled = false;
    localStorage.setItem('theme', 'light');
    
    // Rehighlight code blocks for the new theme
    document.querySelectorAll('pre code').forEach(block => {
        hljs.highlightElement(block);
    });
}
document.addEventListener("DOMContentLoaded", () => {
    const chatContainer = document.getElementById("chat-container");
    const newChatContainer = document.getElementById("new-chat-container");
    const newChatBtn = document.getElementById("new-chat-btn");

    // **Pastikan tombol "Chat Baru" selalu muncul**
    newChatContainer.style.display = "flex"; 

    function resetChat() {
        chatContainer.innerHTML = ''; // Hapus semua chat

        // Tambahkan kembali Welcome Message & Rekomendasi Pertanyaan
        chatContainer.innerHTML = `
            <div class="welcome-message" id="welcome-message">
                <h2>Welcome to Lexxcy AI Assistant!</h2>
                <p>I'm here to help with information, answer questions, generate creative content, and assist with various tasks. Just type your message below to get started!</p>
            </div>
            <div class="question-suggestions" id="question-suggestions">
                <button onclick="fillAndSend('Apa itu AI?')">Apa itu AI?</button>
                <button onclick="fillAndSend('Bagaimana cara kerja AI?')">Bagaimana cara kerja AI?</button>
                <button onclick="fillAndSend('Apa manfaat AI dalam kehidupan sehari-hari?')">Apa manfaat AI dalam kehidupan sehari-hari?</button>
                <button onclick="fillAndSend('Bagaimana AI belajar dari data?')">Bagaimana AI belajar dari data?</button>
            </div>
        `;
    }

    // **Saat tombol "Chat Baru" diklik, reset chat**
    newChatBtn.addEventListener("click", () => {
        resetChat();
    });
});



function enableDarkTheme() {
    rootElement.classList.remove('light-theme');
    themeToggle.innerHTML = lightThemeIcon;
    if (codeThemeDark) codeThemeDark.disabled = false;
    if (codeThemeLight) codeThemeLight.disabled = true;
    localStorage.setItem('theme', 'dark');
    
    // Rehighlight code blocks for the new theme
    document.querySelectorAll('pre code').forEach(block => {
        hljs.highlightElement(block);
    });
}

function showToast(message) {
    const toast = document.getElementById('toast');
    toast.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 2000);
}

function appendMessage(content, isUser = false, originalPrompt = "", messageId = null) {
    const chatContainer = document.getElementById('chat-container');

    // Buat ID unik untuk pesan
    const id = messageId || 'msg-' + Date.now();

    // Bungkus pesan dalam div utama
    const messageWrapper = document.createElement('div');
    messageWrapper.className = `message-wrapper ${isUser ? 'user-message-wrapper' : 'assistant-message-wrapper'}`;
    messageWrapper.id = id;
    messageWrapper.dataset.original = originalPrompt || content;

    // **Tambahkan elemen waktu**
    const timestamp = document.createElement('div');
    timestamp.className = 'chat-timestamp';
    const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    timestamp.textContent = time;

    // Elemen utama pesan
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${isUser ? 'user-message' : 'assistant-message'}`;
    messageDiv.innerHTML = marked.parse(content);

    // **Buat wadah untuk tombol aksi**
    const buttonContainer = document.createElement('div');
    buttonContainer.className = 'button-container';

    if (isUser) {
        // **Tombol Hapus (Hanya untuk pesan pengguna)**
        const deleteButton = document.createElement('button');
        deleteButton.className = 'icon-button delete-btn';
        deleteButton.innerHTML = '<i class="fas fa-trash-alt"></i>';
        deleteButton.onclick = () => deleteMessage(id);

        // **Tombol Salin**
        const copyButton = document.createElement('button');
        copyButton.className = 'icon-button';
        copyButton.innerHTML = '<i class="fas fa-copy"></i>';
        copyButton.onclick = () => {
            navigator.clipboard.writeText(content)
                .then(() => showToast('Copied to clipboard!'))
                .catch(() => showToast('Failed to copy!'));
        };

        // **Tombol Edit**
        const editButton = document.createElement('button');
        editButton.className = 'icon-button';
        editButton.innerHTML = '<i class="fas fa-edit"></i>';
        editButton.onclick = () => startEditing(id, content);

        // **Tambahkan tombol ke pesan pengguna**
        buttonContainer.appendChild(deleteButton);
        buttonContainer.appendChild(copyButton);
        buttonContainer.appendChild(editButton);
    } else {
        // **Tombol Salin untuk jawaban AI**
        const copyButton = document.createElement('button');
        copyButton.className = 'icon-button';
        copyButton.innerHTML = '<i class="fas fa-copy"></i>';
        copyButton.onclick = () => {
            navigator.clipboard.writeText(content)
                .then(() => showToast('Copied to clipboard!'))
                .catch(() => showToast('Failed to copy!'));
        };

        // **Tombol untuk memodifikasi jawaban AI**
        const shortenButton = document.createElement('button');
        shortenButton.className = 'icon-button';
        shortenButton.innerHTML = '<i class="fas fa-compress"></i> Persingkat';
        shortenButton.onclick = () => modifyResponse(id, "shorten");

        const extendButton = document.createElement('button');
        extendButton.className = 'icon-button';
        extendButton.innerHTML = '<i class="fas fa-expand"></i> Perdetail';
        extendButton.onclick = () => modifyResponse(id, "extend");

        const formalButton = document.createElement('button');
        formalButton.className = 'icon-button';
        formalButton.innerHTML = '<i class="fas fa-pen-fancy"></i> Formal';
        formalButton.onclick = () => modifyResponse(id, "formal");

        buttonContainer.appendChild(copyButton);
        buttonContainer.appendChild(shortenButton);
        buttonContainer.appendChild(extendButton);
        buttonContainer.appendChild(formalButton);
    }

    // **Tambahkan elemen ke dalam pesan**
    messageWrapper.appendChild(timestamp);
    messageWrapper.appendChild(messageDiv);
    messageWrapper.appendChild(buttonContainer);
    chatContainer.appendChild(messageWrapper);
    chatContainer.scrollTop = chatContainer.scrollHeight;

    // Render MathJax jika ada rumus matematika
    MathJax.typesetPromise();

    return id;
}



/**
 * Memodifikasi respon AI berdasarkan mode yang dipilih (shorten, extend, formal)
 * @param {string} messageId - ID elemen pesan yang akan dimodifikasi
 * @param {string} mode - Jenis modifikasi ('shorten', 'extend', 'formal')
 */
async function modifyResponse(messageId, mode) {
    // Cek jika sedang dalam proses generasi
    if (isGenerating) {
        showToast('Sedang memproses, harap tunggu...');
        return;
    }

    const messageWrapper = document.getElementById(messageId);
    if (!messageWrapper) {
        showToast('Pesan tidak ditemukan');
        return;
    }

    // Dapatkan teks asli dari pesan asisten
    const assistantMessage = messageWrapper.querySelector('.assistant-message');
    const originalText = assistantMessage.textContent.trim();

    // Buat prompt modifikasi berdasarkan mode
    let modifiedPrompt = "";
    const modeInstructions = {
        shorten: {
            instruction: "Persingkat teks berikut dengan tetap mempertahankan semua poin penting dan inti informasinya. Buat lebih ringkas tanpa menghilangkan makna:",
            emoji: ""
        },
        extend: {
            instruction: "Jelaskan lebih detail dan panjang teks berikut. Tambahkan contoh, penjelasan, dan informasi pendukung yang relevan:",
            emoji: ""
        },
        formal: {
            instruction: "Ubah teks berikut menjadi lebih formal dan profesional tanpa mengubah makna. Gunakan bahasa baku dan struktur kalimat yang tepat:",
            emoji: ""
        }
    };

    if (!modeInstructions[mode]) {
        showToast('Mode modifikasi tidak valid');
        return;
    }

    modifiedPrompt = `${modeInstructions[mode].instruction}\n\n"${originalText}"`;
    const processingMessage = `${modeInstructions[mode].emoji} Memodifikasi...`;

    isGenerating = true;
    const submitBtn = document.getElementById('submit-btn');
    submitBtn.disabled = true;

    // Tambahkan indikator sedang memproses
    const processingIndicator = document.createElement('div');
    processingIndicator.className = 'processing-indicator';
    processingIndicator.textContent = processingMessage;
    messageWrapper.appendChild(processingIndicator);

    try {
        // Buat history baru untuk permintaan modifikasi
        const modifyHistory = [
            ...conversationHistory,
            {
                role: "user",
                parts: [{ text: modifiedPrompt }]
            }
        ];

        // Kirim permintaan ke API
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                contents: modifyHistory,
                generationConfig: {
                    temperature: mode === 'formal' ? 0.3 : 0.7,
                    topK: 40,
                    topP: 0.95,
                    maxOutputTokens: mode === 'extend' ? 4096 : 2048
                }
            })
        });

        const data = await response.json();
        
        if (!response.ok) {
            throw new Error(data.error?.message || `Error ${response.status}`);
        }

        if (data.candidates?.[0]?.content?.parts?.[0]?.text) {
            const responseText = data.candidates[0].content.parts[0].text;
            
            // Hapus pesan asisten yang lama
            messageWrapper.remove();
            
            // Update conversation history
            conversationHistory = modifyHistory;
            conversationHistory.push({
                role: "model",
                parts: [{ text: responseText }]
            });
            
            // Tampilkan respon yang telah dimodifikasi
            appendMessage(responseText, false, modifiedPrompt);
            
            // Scroll ke pesan baru
            const chatContainer = document.getElementById('chat-container');
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            showToast(`Berhasil memodifikasi respon (${mode})`);
        } else {
            throw new Error("Respon tidak valid dari API");
        }
    } catch (error) {
        console.error("Modify Error:", error);
        showToast(`Gagal memodifikasi: ${error.message}`);
    } finally {
        processingIndicator.remove();
        isGenerating = false;
        submitBtn.disabled = false;
    }
}


function startEditing(messageId, content) {
    if (currentlyEditing) {
        cancelEditing();
    }
    
    const messageWrapper = document.getElementById(messageId);
    const originalContent = messageWrapper.innerHTML;
    currentlyEditing = { id: messageId, originalContent };
    
    // Create editing interface
    const editDiv = document.createElement('div');
    editDiv.className = 'edit-message';
    
    const editTextarea = document.createElement('textarea');
    editTextarea.value = content;
    editTextarea.rows = 3;
    editTextarea.className = 'edit-textarea';
    
    const buttonGroup = document.createElement('div');
    buttonGroup.className = 'edit-buttons';
    
    const saveButton = document.createElement('button');
    saveButton.innerHTML = 'Save';
    saveButton.onclick = () => saveEdit(messageId, editTextarea.value);
    
    const cancelButton = document.createElement('button');
    cancelButton.innerHTML = 'Cancel';
    cancelButton.onclick = cancelEditing;
    
    buttonGroup.appendChild(saveButton);
    buttonGroup.appendChild(cancelButton);
    
    editDiv.appendChild(editTextarea);
    editDiv.appendChild(buttonGroup);
    
    // Replace message with editing interface
    messageWrapper.innerHTML = '';
    messageWrapper.appendChild(editDiv);
    
    editTextarea.focus();
}

function saveEdit(messageId, newContent) {
    if (!newContent.trim()) {
        showToast('Message cannot be empty!');
        return;
    }
    
    // Find the index of this message in the conversation history
    const messageWrapper = document.getElementById(messageId);
    let messageIndex = -1;
    
    for (let i = 0; i < conversationHistory.length; i++) {
        if (conversationHistory[i].role === "user" && i < conversationHistory.length - 1) {
            const nextMessage = conversationHistory[i + 1];
            if (nextMessage.role === "model") {
                messageIndex = i;
                break;
            }
        }
    }
    
    if (messageIndex !== -1) {
        // Remove this message and its response from the conversation history
        const removedMessages = conversationHistory.splice(messageIndex, 2);
        
        // Remove the response message from DOM
        const nextMessageElement = messageWrapper.nextElementSibling;
        if (nextMessageElement && nextMessageElement.classList.contains('assistant-message-wrapper')) {
            nextMessageElement.remove();
        }
        
        // Update user message and get new response
        messageWrapper.innerHTML = currentlyEditing.originalContent;
        currentlyEditing = null;
        
        // Update the text content and get a new response
        const contentElement = messageWrapper.querySelector('.message');
        contentElement.innerHTML = marked.parse(newContent);
        
        // Add buttons back
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'button-container';
        
        const copyButton = document.createElement('button');
        copyButton.className = 'icon-button';
        copyButton.innerHTML = '<i class="fas fa-copy"></i>';
        copyButton.onclick = () => {
            navigator.clipboard.writeText(newContent)
                .then(() => showToast('Copied to clipboard!'))
                .catch(() => showToast('Failed to copy!'));
        };
        
        const editButton = document.createElement('button');
        editButton.className = 'icon-button';
        editButton.innerHTML = '<i class="fas fa-edit"></i>';
        editButton.onclick = () => {
            startEditing(messageId, newContent);
        };
        
        buttonContainer.appendChild(copyButton);
        buttonContainer.appendChild(editButton);
        contentElement.appendChild(buttonContainer);
        
        // Generate new response
        generateContent(newContent, false, true);
    } else {
        cancelEditing();
    }
}

function cancelEditing() {
    if (currentlyEditing) {
        const messageWrapper = document.getElementById(currentlyEditing.id);
        messageWrapper.innerHTML = currentlyEditing.originalContent;
        currentlyEditing = null;
    }
}

function showTypingIndicator() {
    const chatContainer = document.getElementById('chat-container');
    const typingDiv = document.createElement('div');
    typingDiv.className = 'typing-indicator';
    typingDiv.innerHTML = `
        <div class="typewriter">
            <div class="slide"><i></i></div>
            <div class="paper"></div>
            <div class="keyboard"></div>
        </div>
        <p style="margin-top: 10px; font-size: 0.8rem; color: var(--text-muted)">Lexxcy AI sedang mengetik...</p>
    `;
    chatContainer.appendChild(typingDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;
    return typingDiv;
}

function removeTypingIndicator(indicator) {
    if (indicator && indicator.parentElement) {
        indicator.remove();
    }
}

// Replace the existing Enter key event listener with this one
document.getElementById('prompt').addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {
        // Check if Shift key is pressed along with Enter
        if (event.shiftKey) {
            // Default behavior - create a new line and don't send
        } else {
            // If Enter is pressed without Shift, create a new line instead of sending
            event.preventDefault();
            const cursorPosition = this.selectionStart;
            const textBeforeCursor = this.value.substring(0, cursorPosition);
            const textAfterCursor = this.value.substring(cursorPosition);
            
            // Insert a newline character at the cursor position
            this.value = textBeforeCursor + '\n' + textAfterCursor;
            
            // Move the cursor position after the inserted newline
            this.selectionStart = this.selectionEnd = cursorPosition + 1;
            
            // Trigger the auto-resize function
            autoResize(this);
        }
    }
});

// Add a new event listener for Ctrl+Enter to send the message
document.getElementById('prompt').addEventListener('keydown', function(event) {
    // Send message on Ctrl+Enter or Cmd+Enter (for Mac)
    if (event.key === 'Enter' && (event.ctrlKey || event.metaKey)) {
        event.preventDefault();
        generateContent();
    }
});

async function generateContent(prompt = null, isRegenerate = false, isEdit = false) {
    if (isGenerating) return;

    const promptInput = document.getElementById('prompt');
    const submitBtn = document.getElementById('submit-btn');
    let userPrompt = prompt ? prompt : promptInput.value.trim();

    if (!userPrompt) return;

    isGenerating = true;
    promptInput.disabled = true;
    submitBtn.disabled = true;

    // Add user message to chat if not regenerating or editing
    let messageId = null;
    if (!isRegenerate && !isEdit) {
        messageId = appendMessage(userPrompt, true, userPrompt);
        
        // Add to conversation history
        conversationHistory.push({
            role: "user",
            parts: [{ text: userPrompt }]
        });
    } else if (isEdit) {
        // Add edited message to conversation history
        conversationHistory.push({
            role: "user",
            parts: [{ text: userPrompt }]
        });
    }

    const typingIndicator = showTypingIndicator();
    if (!isRegenerate && !isEdit) {
        promptInput.value = '';
        autoResize(promptInput);
    }

    try {
        // Prepare the conversation for multi-turn context
        let requestBody = {
            generationConfig: { 
                temperature: 0.7, 
                topK: 40, 
                topP: 0.95, 
                maxOutputTokens: 2048 
            }
        };
        
        // If regenerating, remove the last assistant response
        if (isRegenerate && conversationHistory.length > 1 && conversationHistory[conversationHistory.length - 1].role === "model") {
            conversationHistory.pop();
        }
        
        // Use contents for multi-turn conversation
        requestBody.contents = conversationHistory;
        
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(requestBody)
        });

        const data = await response.json();
        removeTypingIndicator(typingIndicator);

        if (!response.ok) {
            appendMessage(`Error: ${data.error?.message || 'Status code ' + response.status}`);
            return;
        }

        if (data.candidates?.[0]?.content?.parts?.[0]?.text) {
            const responseText = data.candidates[0].content.parts[0].text;
            appendMessage(responseText, false, userPrompt);
            
            // Add the response to conversation history
            conversationHistory.push({
                role: "model",
                parts: [{ text: responseText }]
            });
        } else {
            appendMessage("Sorry, I couldn't generate a response for that query.");
        }
    } catch (error) {
        removeTypingIndicator(typingIndicator);
        appendMessage("Error connecting to the API. Please try again.");
        console.error("API Error:", error);
    } finally {
        isGenerating = false;
        promptInput.disabled = false;
        submitBtn.disabled = false;
        promptInput.focus();
    }
}

// Clear chat functionality
function clearChat() {
    const chatContainer = document.getElementById('chat-container');
    chatContainer.innerHTML = `
        <div class="welcome-message">
            <h2>Welcome to Lexxcy AI Assistant!</h2>
            <p>I'm here to help with information, answer questions, generate creative content, and assist with various tasks. Just type your message below to get started!</p>
        </div>
        <div class="question-suggestions" id="question-suggestions">
            <button onclick="fillAndSend('Apa itu AI?')">Apa itu AI?</button>
            <button onclick="fillAndSend('Bagaimana cara kerja AI?')">Bagaimana cara kerja AI?</button>
            <button onclick="fillAndSend('Apa manfaat AI dalam kehidupan sehari-hari?')">Apa manfaat AI dalam kehidupan sehari-hari?</button>
            <button onclick="fillAndSend('Bagaimana AI belajar dari data?')">Bagaimana AI belajar dari data?</button>
        </div>
    `;
    conversationHistory = [];
}


document.addEventListener('DOMContentLoaded', () => {
    const promptInput = document.getElementById('prompt');
    promptInput.focus();
});

window.addEventListener("beforeunload", function (event) {
    event.preventDefault();
    event.returnValue = "Apakah Anda yakin ingin me-refresh halaman? Chat Anda akan hilang.";
});

function autoResize(textarea) {
    textarea.style.height = "auto"; // Reset height for accurate calculation
    const maxHeight = 5 * 24; // Maximum 5 lines (assuming font height is 24px)
    
    if (textarea.scrollHeight > maxHeight) {
        textarea.style.height = maxHeight + "px"; // Limit to max 5 lines
        textarea.style.overflowY = "scroll"; // Enable scroll if more than 5 lines
    } else {
        textarea.style.height = textarea.scrollHeight + "px"; // Adjust height
        textarea.style.overflowY = "hidden"; // Hide scrollbar if less than 5 lines
    }
}



document.addEventListener("DOMContentLoaded", function () {
    const sidebar = document.getElementById("sidebar");
    const menuButton = document.getElementById("menu-button");

    // Tutup sidebar jika klik di luar area sidebar
    document.addEventListener("click", function (event) {
        if (!sidebar.contains(event.target) && !menuButton.contains(event.target)) {
            sidebar.classList.remove("show");
        }
    });

    // Toggle sidebar saat tombol menu diklik
    menuButton.addEventListener("click", function () {
        sidebar.classList.toggle("show");
    });
});


document.addEventListener('touchend', function(event) {
    touchEndX = event.changedTouches[0].clientX;

    // Geser ke kanan (Buka menu)
    if (touchEndX > touchStartX + 50) {
        document.getElementById('sidebar').classList.add('show');
    }



    // Geser ke kiri (Tutup menu)
    if (touchStartX > touchEndX + 50) {
        document.getElementById('sidebar').classList.remove('show');
    }
}, false);

function hideSuggestions() {
    const suggestions = document.getElementById('question-suggestions');
    if (suggestions) {
        suggestions.style.display = 'none';
    }
}

function fillAndSend(question) {
    document.getElementById('prompt').value = question;
    hideSuggestions(); // Sembunyikan rekomendasi saat diklik
    generateContent(); // Kirim pertanyaan
}

document.getElementById('submit-btn').addEventListener('click', function() {
    hideSuggestions(); // Sembunyikan rekomendasi saat pengguna mengirim pertanyaan
});

document.getElementById('prompt').addEventListener('keydown', function(event) {
    if (event.key === 'Enter' && (event.ctrlKey || event.metaKey)) {
        hideSuggestions(); // Sembunyikan rekomendasi jika pengguna mengirim dengan Ctrl+Enter
    }
});

document.addEventListener('DOMContentLoaded', function() {
    // Create and append image upload elements to the input container
    const inputWrapper = document.querySelector('.input-wrapper');
    
    // Create image upload button
    const imageUploadLabel = document.createElement('label');
    imageUploadLabel.className = 'image-upload-btn';
    imageUploadLabel.innerHTML = '<i class="fas fa-image"></i>';
    imageUploadLabel.title = 'Unggah Gambar';
    
    // Create file input element (hidden)
    const imageInput = document.createElement('input');
    imageInput.type = 'file';
    imageInput.id = 'image-upload';
    imageInput.accept = 'image/*';
    imageInput.style.display = 'none';
    
    // Append elements
    imageUploadLabel.appendChild(imageInput);
    inputWrapper.insertBefore(imageUploadLabel, document.getElementById('submit-btn'));
    
    // Image preview container in chat
    const chatContainer = document.getElementById('chat-container');
    
// Di dalam event listener imageInput.addEventListener('change')
imageInput.addEventListener('change', async function(event) {
    if (event.target.files && event.target.files[0]) {
        const file = event.target.files[0];

        // Validate file type
        if (!file.type.match('image.*')) {
            showToast('Hanya file gambar (JPEG, PNG, GIF) yang diperbolehkan');
            return;
        }

        // Create message container
        const messageId = 'img-' + Date.now();
        const messageWrapper = document.createElement('div');
        messageWrapper.className = 'message-wrapper user-message-wrapper';
        messageWrapper.id = messageId;

        const messageDiv = document.createElement('div');
        messageDiv.className = 'message user-message';

        // Add image preview
        const imageUrl = URL.createObjectURL(file);
        const imageElement = document.createElement('img');
        imageElement.src = imageUrl;
        imageElement.className = 'uploaded-image';
        imageElement.alt = 'Gambar yang diunggah';

        // Add command input section
        const commandContainer = document.createElement('div');
        commandContainer.className = 'command-container';

        const commandInput = document.createElement('textarea');
        commandInput.className = 'command-input';
        commandInput.placeholder = 'Tambahkan perintah untuk gambar ini (opsional)...';
        commandInput.rows = 2;

        // Add action buttons
        const actionButtons = document.createElement('div');
        actionButtons.className = 'action-buttons';

        const analyzeButton = document.createElement('button');
        analyzeButton.className = 'analyze-button primary';
        analyzeButton.innerHTML = '<i class="fas fa-search"></i> Analisis';
        
        const cancelButton = document.createElement('button');
        cancelButton.className = 'cancel-button secondary';
        cancelButton.innerHTML = '<i class="fas fa-times"></i> Batal';

        // Button event handlers
        analyzeButton.onclick = async () => {
            const command = commandInput.value.trim();
            
            // Disable button during processing
            analyzeButton.disabled = true;
            analyzeButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Memproses...';
            
            await processImageWithCommand(file, command, messageId);
            
            // Remove input section after analysis
            commandContainer.remove();
        };

        cancelButton.onclick = () => {
            if (confirm('Batalkan analisis gambar ini?')) {
                messageWrapper.remove();
            }
        };

        // Build the DOM structure
        actionButtons.appendChild(analyzeButton);
        actionButtons.appendChild(cancelButton);
        commandContainer.appendChild(commandInput);
        commandContainer.appendChild(actionButtons);

        messageDiv.appendChild(imageElement);
        messageDiv.appendChild(commandContainer);
        messageWrapper.appendChild(messageDiv);

        // Add to chat container
        const chatContainer = document.getElementById('chat-container');
        chatContainer.appendChild(messageWrapper);
        
        // Scroll to show the new message
        messageWrapper.scrollIntoView({ behavior: 'smooth' });

        // Focus on command input
        commandInput.focus();

        // Handle Enter key in command input
        commandInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                analyzeButton.click();
            }
        });
    }
});

// Function to process image with command
async function processImageWithCommand(imageFile, command = "", messageId, isFromCamera = false) {
    const typingIndicator = showTypingIndicator();
    
    try {
        const base64Image = await convertToBase64(imageFile);
        
        const requestBody = {
            contents: [
                {
                    role: "user",
                    parts: [
                        { text: command || "Tolong jelaskan apa yang Anda lihat dalam gambar ini:" },
                        {
                            inline_data: {
                                mime_type: imageFile.type,
                                data: base64Image.split(',')[1]
                            }
                        }
                    ]
                }
            ],
            generationConfig: { 
                temperature: 0.7, 
                topK: 40, 
                topP: 0.95, 
                maxOutputTokens: 2048 
            }
        };
        
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(requestBody)
        });
        
        const data = await response.json();
        removeTypingIndicator(typingIndicator);
        
        if (!response.ok) {
            appendMessage(`Error memproses gambar: ${data.error?.message || 'Status code ' + response.status}`);
            return;
        }
        
        if (data.candidates?.[0]?.content?.parts?.[0]?.text) {
            const responseText = data.candidates[0].content.parts[0].text;
            appendMessage(responseText, false, command || "Analisis Gambar");
            
            // Update message with command text if from camera
            if (isFromCamera) {
                const messageWrapper = document.getElementById(messageId);
                if (messageWrapper) {
                    const commandText = document.createElement('div');
                    commandText.className = 'image-command-text';
                    commandText.textContent = `Perintah: ${command || "Analisis gambar"}`;
                    messageWrapper.querySelector('.message').appendChild(commandText);
                }
            }
            
            // Add to conversation history
            conversationHistory.push({
                role: "user",
                parts: [
                    { text: command || "Analisis gambar ini:" },
                    {
                        inline_data: {
                            mime_type: imageFile.type,
                            data: base64Image.split(',')[1]
                        }
                    }
                ]
            });
            
            conversationHistory.push({
                role: "model",
                parts: [{ text: responseText }]
            });
        } else {
            appendMessage("Maaf, saya tidak dapat menganalisis gambar dengan benar.");
        }
    } catch (error) {
        removeTypingIndicator(typingIndicator);
        appendMessage("Error memproses gambar. Silakan coba lagi.");
        console.error("Image Processing Error:", error);
    }
}

// Helper function to convert image to base64
function convertToBase64(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = error => reject(error);
        reader.readAsDataURL(file);
    });
}
    
    // Function to process image and get AI response
// Modifikasi fungsi processImageWithCommand
async function processImageWithCommand(imageFile, command = "", messageId, isFromCamera = false) {
    const typingIndicator = showTypingIndicator();
    
    try {
        const base64Image = await convertToBase64(imageFile);
        
        const requestBody = {
            contents: [
                {
                    role: "user",
                    parts: [
                        { text: command || "Tolong jelaskan apa yang Anda lihat dalam gambar ini:" },
                        {
                            inline_data: {
                                mime_type: imageFile.type,
                                data: base64Image.split(',')[1]
                            }
                        }
                    ]
                }
            ],
            generationConfig: { 
                temperature: 0.7, 
                topK: 40, 
                topP: 0.95, 
                maxOutputTokens: 2048 
            }
        };
        
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(requestBody)
        });
        
        const data = await response.json();
        removeTypingIndicator(typingIndicator);
        
        if (!response.ok) {
            appendMessage(`Error memproses gambar: ${data.error?.message || 'Status code ' + response.status}`);
            return;
        }
        
        if (data.candidates?.[0]?.content?.parts?.[0]?.text) {
            const responseText = data.candidates[0].content.parts[0].text;
            
            // Dapatkan elemen pesan asli yang berisi gambar
            const originalMessage = document.getElementById(messageId);
            if (originalMessage) {
                // Tambahkan teks perintah di bawah gambar
                const commandText = document.createElement('div');
                commandText.className = 'image-command-text';
                commandText.innerHTML = `<strong>Perintah:</strong> ${command || "Analisis gambar"}`;
                
                // Temukan div message di dalam wrapper
                const messageDiv = originalMessage.querySelector('.message');
                if (messageDiv) {
                    // Sisipkan teks perintah setelah gambar tapi sebelum tombol (jika ada)
                    const img = messageDiv.querySelector('img');
                    if (img) {
                        img.insertAdjacentElement('afterend', commandText);
                    } else {
                        messageDiv.insertBefore(commandText, messageDiv.firstChild);
                    }
                }
            }
            
            // Tambahkan jawaban AI
            appendMessage(responseText, false);
            
            // Tambahkan ke riwayat percakapan
            conversationHistory.push({
                role: "user",
                parts: [
                    { text: command || "Analisis gambar ini:" },
                    {
                        inline_data: {
                            mime_type: imageFile.type,
                            data: base64Image.split(',')[1]
                        }
                    }
                ]
            });
            
            conversationHistory.push({
                role: "model",
                parts: [{ text: responseText }]
            });
        } else {
            appendMessage("Maaf, saya tidak dapat menganalisis gambar dengan benar.");
        }
    } catch (error) {
        removeTypingIndicator(typingIndicator);
        appendMessage("Error memproses gambar. Silakan coba lagi.");
        console.error("Image Processing Error:", error);
    }
}
    
    // Convert image file to base64
    function convertToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
            reader.readAsDataURL(file);
        });
    }
    
// Camera capture functionality
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
    let stream = null;
    let useFrontCamera = false;

    // Create camera button
    const cameraButton = document.createElement('button');
    cameraButton.className = 'camera-btn';
    cameraButton.innerHTML = '<i class="fas fa-camera"></i>';
    cameraButton.title = 'Ambil Foto';
    inputWrapper.insertBefore(cameraButton, document.getElementById('submit-btn'));

    // Camera modal
    const cameraModal = document.createElement('div');
    cameraModal.className = 'camera-modal';
    cameraModal.style.display = 'none';

    const modalContent = document.createElement('div');
    modalContent.className = 'camera-modal-content';

    const videoElement = document.createElement('video');
    videoElement.autoplay = true;
    videoElement.playsInline = true;
    videoElement.className = 'camera-video';

    const buttonContainer = document.createElement('div');
    buttonContainer.className = 'camera-controls';

    // Tombol Close
    const closeButton = document.createElement('button');
    closeButton.className = 'camera-close-btn';
    closeButton.innerHTML = '<i class="fas fa-times"></i>';
    closeButton.title = 'Tutup Kamera';

    // Tombol Ganti Kamera
    const switchButton = document.createElement('button');
    switchButton.className = 'camera-switch-btn';
    switchButton.innerHTML = '<i class="fas fa-sync-alt"></i>';
    switchButton.title = 'Ganti Kamera';

    // Tombol Ambil Foto (besar di tengah)
    const captureButton = document.createElement('button');
    captureButton.className = 'camera-capture-btn';
    captureButton.innerHTML = '<i class="fas fa-circle"></i>';
    captureButton.title = 'Ambil Foto';

    const canvasElement = document.createElement('canvas');
    canvasElement.className = 'camera-canvas';
    canvasElement.style.display = 'none';

    modalContent.appendChild(videoElement);
    modalContent.appendChild(buttonContainer);
    modalContent.appendChild(canvasElement);
    
    buttonContainer.appendChild(closeButton);
    buttonContainer.appendChild(captureButton);
    buttonContainer.appendChild(switchButton);
    
    cameraModal.appendChild(modalContent);
    document.body.appendChild(cameraModal);

    // Open camera function
    async function openCamera() {
        try {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            stream = await navigator.mediaDevices.getUserMedia({
                video: { 
                    facingMode: useFrontCamera ? 'user' : 'environment',
                    width: { ideal: 1280 },
                    height: { ideal: 720 }
                }
            });
            videoElement.srcObject = stream;
            videoElement.style.display = 'block';
            canvasElement.style.display = 'none';
            cameraModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        } catch (error) {
            console.error('Camera error:', error);
            showToast('Tidak dapat mengakses kamera: ' + error.message);
        }
    }

    // Close camera function
    function closeCamera() {
        if (stream) {
            stream.getTracks().forEach(track => track.stop());
            stream = null;
        }
        cameraModal.style.display = 'none';
        document.body.style.overflow = '';
    }

    // Event listeners
    cameraButton.addEventListener('click', openCamera);
    
    switchButton.addEventListener('click', () => {
        useFrontCamera = !useFrontCamera;
        openCamera();
    });

    closeButton.addEventListener('click', closeCamera);

    captureButton.addEventListener('click', () => {
        const context = canvasElement.getContext('2d');
        canvasElement.width = videoElement.videoWidth;
        canvasElement.height = videoElement.videoHeight;
        context.drawImage(videoElement, 0, 0, canvasElement.width, canvasElement.height);

        canvasElement.toBlob((blob) => {
            closeCamera();
            
            // Buat wadah pesan untuk gambar dari kamera
            const messageId = 'msg-' + Date.now();
            const messageWrapper = document.createElement('div');
            messageWrapper.className = 'message-wrapper user-message-wrapper';
            messageWrapper.id = messageId;

            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';

            const imageElement = document.createElement('img');
            imageElement.src = URL.createObjectURL(blob);
            imageElement.className = 'uploaded-image';
            imageElement.alt = 'Gambar dari kamera';

            const confirmationDiv = document.createElement('div');
            confirmationDiv.className = 'message-confirmation';

            const commandInput = document.createElement('textarea');
            commandInput.className = 'command-input';
            commandInput.placeholder = 'Tambahkan perintah untuk gambar ini...';
            commandInput.rows = 2;

            const buttonGroup = document.createElement('div');
            buttonGroup.className = 'confirmation-buttons';

            const sendButton = document.createElement('button');
            sendButton.className = 'confirm-send-btn';
            sendButton.innerHTML = '<i class="fas fa-paper-plane"></i> Analisis';

            const cancelButton = document.createElement('button');
            cancelButton.className = 'cancel-send-btn';
            cancelButton.innerHTML = '<i class="fas fa-times"></i> Batal';

            buttonGroup.appendChild(sendButton);
            buttonGroup.appendChild(cancelButton);
            confirmationDiv.appendChild(commandInput);
            confirmationDiv.appendChild(buttonGroup);

            messageDiv.appendChild(imageElement);
            messageDiv.appendChild(confirmationDiv);
            messageWrapper.appendChild(messageDiv);

            const chatContainer = document.getElementById('chat-container');
            chatContainer.appendChild(messageWrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;

            sendButton.addEventListener('click', function() {
                const command = commandInput.value.trim();
                const file = new File([blob], "camera-capture.jpg", { type: "image/jpeg" });
                confirmationDiv.remove();
                processImageWithCommand(file, command, messageId, true);
            });

            cancelButton.addEventListener('click', function() {
                messageWrapper.remove();
            });
            
            commandInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendButton.click();
                }
            });
        }, 'image/jpeg', 0.9);
    });
}
    
    // Translation function
    async function translateToIndonesian(text) {
        try {
            const response = await fetch(`https://translation.googleapis.com/language/translate/v2?key=${API_KEY}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    q: text,
                    source: 'en',
                    target: 'id',
                    format: 'text'
                })
            });
            
            const data = await response.json();
            
            if (data.data && data.data.translations && data.data.translations.length > 0) {
                return data.data.translations[0].translatedText;
            } else {
                console.error('Translation error:', data);
                return text; // Return original text if translation fails
            }
        } catch (error) {
            console.error('Translation service error:', error);
            return text; // Return original text if translation fails
        }
    }
    
    // Modify the original submit button behavior
    const originalSubmitButton = document.getElementById('submit-btn');
    const originalForm = document.querySelector('form');
    
    if (originalForm) {
        // Remove the original form submit event
        originalForm.onsubmit = null;
        
        // Add new submit event
        originalForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userInput = document.getElementById('user-input');
            const message = userInput.value.trim();
            
            if (message) {
                // Create message preview with confirmation
                const messageId = 'msg-' + Date.now();
                const messageWrapper = document.createElement('div');
                messageWrapper.className = 'message-wrapper user-message-wrapper';
                messageWrapper.id = messageId;
                
                // Create message content
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message user-message';
                messageDiv.textContent = message;
                
                // Add confirmation buttons
                const confirmationDiv = document.createElement('div');
                confirmationDiv.className = 'message-confirmation';
                
                const sendButton = document.createElement('button');
                sendButton.className = 'confirm-send-btn';
                sendButton.innerHTML = '<i class="fas fa-paper-plane"></i> Kirim';
                
                const cancelButton = document.createElement('button');
                cancelButton.className = 'cancel-send-btn';
                cancelButton.innerHTML = '<i class="fas fa-times"></i> Batal';
                
                const editButton = document.createElement('button');
                editButton.className = 'edit-message-btn';
                editButton.innerHTML = '<i class="fas fa-edit"></i> Edit';
                
                confirmationDiv.appendChild(sendButton);
                confirmationDiv.appendChild(editButton);
                confirmationDiv.appendChild(cancelButton);
                
                // Append elements
                messageDiv.appendChild(confirmationDiv);
                messageWrapper.appendChild(messageDiv);
                chatContainer.appendChild(messageWrapper);
                chatContainer.scrollTop = chatContainer.scrollHeight;
                
                // Clear input field
                userInput.value = '';
                
                // Send button event listener
                sendButton.addEventListener('click', function() {
                    // Remove confirmation buttons
                    confirmationDiv.remove();
                    
                    // Process the message
                    window.processMessage(message);
                });
                
                // Edit button event listener
                editButton.addEventListener('click', function() {
                    // Put the message back in the input field
                    userInput.value = message;
                    userInput.focus();
                    
                    // Remove the message from chat
                    messageWrapper.remove();
                });
                
                // Cancel button event listener
                cancelButton.addEventListener('click', function() {
                    // Remove the message from chat
                    messageWrapper.remove();
                });
            }
        });
    }
    
    // Override the message processing function to translate responses to Indonesian
    const originalProcessMessage = window.processMessage;
    window.processMessage = async function(message) {
        // Show typing indicator
        const typingIndicator = showTypingIndicator();
        
        try {
            // Get AI response in English
            const response = await originalGetAIResponse(message);
            removeTypingIndicator(typingIndicator);
            
            // Translate the response to Indonesian
            const translatedResponse = await translateToIndonesian(response);
            
            // Append the translated message
            appendMessage(translatedResponse, false);
            
            // Add to conversation history
            conversationHistory.push({
                role: "user",
                parts: [{ text: message }]
            });
            
            conversationHistory.push({
                role: "model",
                parts: [{ text: translatedResponse }]
            });
            
            // Clear input
            document.getElementById('user-input').value = '';
            
            // Reset thinking dots
            resetThinkingDots();
        } catch (error) {
            removeTypingIndicator(typingIndicator);
            appendMessage("Maaf, ada masalah dalam memproses pesan Anda. Silakan coba lagi.");
            console.error("Error:", error);
        }
    };
    
    // Save the original getAIResponse function
    const originalGetAIResponse = window.getAIResponse;
    
    // Update UI elements with Indonesian language
    function updateUIToIndonesian() {
        // Update placeholders
        const userInput = document.getElementById('user-input');
        if (userInput) {
            userInput.placeholder = 'Ketik pesan Anda di sini...';
        }
        
        // Update button text/titles
        const submitBtn = document.getElementById('submit-btn');
        if (submitBtn) {
            submitBtn.title = 'Kirim';
        }
        
        // Update other UI elements
        const welcomeMessage = document.querySelector('.welcome-message');
        if (welcomeMessage) {
            welcomeMessage.innerHTML = `
                <h2>Selamat Datang di Lexxcy AI Assistant!</h2>
                <p>Saya asisten AI Anda yang dapat membantu Anda dengan berbagai tugas. Tanyakan apa saja!.Anda juga dapat mengunggah gambar, dan saya akan mencoba menganalisisnya untuk Anda.</p>
            `;
        }
    }
    
    // Call the function to update UI
    updateUIToIndonesian();
    
    // Show toast messages in Indonesian
    window.showToast = function(message, duration = 3000) {
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => {
            toast.classList.add('show');
        }, 10);
        
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => {
                document.body.removeChild(toast);
            }, 300);
        }, duration);
    };
    
    // Add CSS for confirmation buttons and other new elements
    const style = document.createElement('style');
    style.textContent = `
        /* Additional styling for Indonesian text if needed */
        .message {
            font-family: 'Roboto', 'Noto Sans', sans-serif;
            position: relative;
        }
        
        .camera-modal .capture-btn {
            background-color: #4CAF50;
        }
        
        .camera-modal .close-btn {
            background-color: #f44336;
        }
        
        .message-confirmation {
            display: flex;
            justify-content: flex-end;
            margin-top: 8px;
            gap: 8px;
        }
        
        .confirm-send-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .edit-message-btn {
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .cancel-send-btn {
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .confirm-send-btn:hover, .edit-message-btn:hover, .cancel-send-btn:hover {
            opacity: 0.9;
        }
    `;
    document.head.appendChild(style);
});
document.addEventListener('DOMContentLoaded', function() {
    let draggingCounter = 0; // Untuk mendeteksi kapan drag selesai

    // Saat file mulai diseret ke halaman
    document.addEventListener('dragover', function(event) {
        event.preventDefault();
        if (draggingCounter === 0) {
            document.body.classList.add('dragging'); // Tambah efek latar
        }
        draggingCounter++;
    });

    // Saat file keluar dari halaman tanpa dijatuhkan
    document.addEventListener('dragleave', function() {
        draggingCounter--;
        if (draggingCounter === 0) {
            document.body.classList.remove('dragging'); // Hapus efek latar
        }
    });

    // Saat file dijatuhkan di mana saja di halaman
    document.addEventListener('drop', function(event) {
        event.preventDefault();
        document.body.classList.remove('dragging');
        draggingCounter = 0; // Reset counter

        let files = event.dataTransfer.files;

        if (files.length === 1 && files[0].type.startsWith('image/')) {
            // Jika hanya satu gambar, tampilkan di chat
            previewAndSendImage(files[0]);
        } else {
            // Jika bukan gambar atau lebih dari satu file, tampilkan jumlah file
            appendMessage(`Anda mengunggah ${files.length} file.`, false);
        }
    });

    function previewAndSendImage(file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const chatContainer = document.getElementById('chat-container');
            const messageWrapper = document.createElement('div');
            messageWrapper.className = 'message-wrapper user-message-wrapper';

            const messageDiv = document.createElement('div');
            messageDiv.className = 'message user-message';

            const imageElement = document.createElement('img');
            imageElement.src = e.target.result;
            imageElement.className = 'uploaded-image';
            imageElement.alt = 'Gambar yang diunggah';

            messageDiv.appendChild(imageElement);
            messageWrapper.appendChild(messageDiv);
            chatContainer.appendChild(messageWrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        };
        reader.readAsDataURL(file);
    }
});
function formatResponse(text) {
    // **Bold** dan *Italic* hanya jika terdapat spasi sebelum atau setelahnya
    text = text.replace(/(?<=\s|\n)\*\*(.*?)\*\*(?=\s|\n)/g, '<strong>$1</strong>'); // **bold**
    text = text.replace(/(?<=\s|\n)\*(.*?)\*(?=\s|\n)/g, '<em>$1</em>'); // *italic*

    // Judul Markdown
    text = text.replace(/^### (.*$)/gim, '<h3>$1</h3>'); // H3
    text = text.replace(/^## (.*$)/gim, '<h2>$1</h2>'); // H2
    text = text.replace(/^# (.*$)/gim, '<h1>$1</h1>'); // H1

    // Kutipan (>)
    text = text.replace(/^> (.*$)/gim, '<blockquote>$1</blockquote>');

    // Daftar Bullet (Menghindari pengubahan teks yang mengandung *)
    text = text.replace(/^\s*\*\s(.*$)/gim, '<ul><li>$1</li></ul>');
    text = text.replace(/<\/ul>\s*<ul>/g, ''); // Gabungkan daftar bertingkat

    // Daftar Angka (1. item)
    text = text.replace(/^\s*\d+\.\s(.*$)/gim, '<ol><li>$1</li></ol>');
    text = text.replace(/<\/ol>\s*<ol>/g, ''); // Gabungkan daftar bertingkat

    // Blok Kode (``` kode ```)
    text = text.replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>');

    // Hilangkan bintang (*) yang tidak digunakan untuk pemformatan
    text = text.replace(/(?<!\w)\*(?!\w)/g, '');

    // Gantikan newline (\n) dengan <br> jika tidak dalam elemen kode atau daftar
    text = text.replace(/(?<!<\/?(?:h1|h2|h3|ul|ol|li|blockquote|pre|code)>)\n/g, '<br>');

    return text;
}

function formatTable(content) {
    // Cek apakah ada tabel dalam format Markdown
    if (content.includes('|') && content.includes('---')) {
        let formattedContent = content
            .replace(/\|/g, '</td><td>') // Ganti | dengan <td>
            .replace(/<\/td><td>---<\/td><td>/g, '</th></tr><tr><td>') // Ganti separator
            .replace(/<td>---<\/td>/g, '<th>') // Ganti header
            .replace(/<\/td><td>---<\/td>/g, '</th><th>') // Perbaiki header

        return `<div class="table-container">
                    <table class="ai-table">
                        <tr><th>${formattedContent}</td></tr>
                    </table>
                </div>`;
    }
    return content;
}

const chatSidebar = document.getElementById('chat-sidebar');
const chatList = document.getElementById('chat-list');
const newChatBtn = document.getElementById('new-chat-btn');
const deleteModal = document.getElementById('delete-modal');
const confirmDeleteBtn = document.getElementById('confirm-delete');
const cancelDeleteBtn = document.getElementById('cancel-delete');

let chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];
let currentChatIndex = null;
let chatToDelete = null;

// **Tampilkan Sidebar Saat Geser ke Kanan**
document.addEventListener('touchstart', (e) => {
    if (e.touches[0].clientX < 50) {
        chatSidebar.classList.add('show');
    }
});

// **Fungsi Menyimpan Chat dengan Nama Otomatis**
let currentChatId = null; // ID chat yang sedang aktif

function saveChatToHistory() {
    const messages = Array.from(document.querySelectorAll('.message-wrapper')).map(msg => {
        const messageDiv = msg.querySelector('.message');
        let content = '';
        let imageUrl = '';
        
        // Cek apakah ada gambar dalam pesan
        const img = messageDiv.querySelector('img');
        if (img) {
            imageUrl = img.src;
            content = messageDiv.textContent.trim(); // Teks yang menyertai gambar
        } else {
            content = messageDiv.textContent.trim();
        }
        
        return {
            content: content,
            isUser: msg.classList.contains('user-message-wrapper'),
            timestamp: msg.querySelector('.chat-timestamp')?.textContent || '',
            imageUrl: imageUrl
        };
    });

    if (messages.length === 0) return;

    // Jika chat sedang aktif, update yang ada
    if (currentChatId !== null) {
        const index = chatHistory.findIndex(chat => chat.id === currentChatId);
        if (index !== -1) {
            chatHistory[index].messages = messages;
            chatHistory[index].lastUpdated = new Date().toISOString();
        }
    } else {
        // Buat chat baru
        const chatTitle = messages[0].content.substring(0, 20) + 
                         (messages[0].content.length > 20 ? "..." : "") + 
                         (messages[0].imageUrl ? " [Gambar]" : "");
        chatHistory.push({
            id: Date.now().toString(),
            title: chatTitle,
            messages: messages,
            created: new Date().toISOString(),
            lastUpdated: new Date().toISOString()
        });
    }
    
    localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
    renderChatHistory();
}

function renderChatHistory() {
    const chatList = document.getElementById('chat-list');
    chatList.innerHTML = '';
    
    if (chatHistory.length === 0) {
        document.getElementById('no-chat-message').style.display = 'block';
        return;
    }
    
    document.getElementById('no-chat-message').style.display = 'none';
    
    // Urutkan berdasarkan waktu terbaru
    chatHistory.sort((a, b) => new Date(b.lastUpdated) - new Date(a.lastUpdated));
    
    chatHistory.forEach(chat => {
        const listItem = document.createElement('li');
        listItem.dataset.chatId = chat.id;
        
        // Wrapper untuk judul dan waktu
        const titleWrapper = document.createElement('div');
        titleWrapper.className = 'chat-title-wrapper';
        
        const title = document.createElement('span');
        title.className = 'chat-title';
        
        // Tambahkan ikon gambar jika chat mengandung gambar
        const hasImages = chat.messages.some(msg => msg.imageUrl);
        title.textContent = chat.title + (hasImages ? ' [Gambar]' : '');
        
        const time = document.createElement('span');
        time.className = 'chat-time';
        time.textContent = formatRelativeTime(chat.lastUpdated);
        
        titleWrapper.appendChild(title);
        titleWrapper.appendChild(time);
        
        // Tombol hapus
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'delete-chat';
        deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
        deleteBtn.onclick = (e) => {
            e.stopPropagation();
            deleteChat(chat.id);
        };
        
        listItem.appendChild(titleWrapper);
        listItem.appendChild(deleteBtn);
        
        // Highlight chat aktif
        if (currentChatId === chat.id) {
            listItem.classList.add('active');
            listItem.querySelector('.delete-chat').style.opacity = '1';
        }
        
        listItem.addEventListener('click', () => loadChat(chat.id));
        chatList.appendChild(listItem);
    });
    
    // Auto-update waktu setiap menit
    setTimeout(renderChatHistory, 60000);
}

// Panggil fungsi ini saat halaman dimuat dan setiap kali ada perubahan riwayat chat
document.addEventListener('DOMContentLoaded', renderChatHistory);

function formatRelativeTime(timestamp) {
    const now = new Date();
    const messageTime = new Date(timestamp);
    const diffInSeconds = Math.floor((now - messageTime) / 1000);
    
    if (diffInSeconds < 60) {
        return 'Baru saja';
    } else if (diffInSeconds < 3600) {
        const minutes = Math.floor(diffInSeconds / 60);
        return `${minutes} menit lalu`;
    } else if (diffInSeconds < 86400) {
        const hours = Math.floor(diffInSeconds / 3600);
        return `${hours} jam lalu`;
    } else {
        return messageTime.toLocaleDateString('id-ID', {
            day: 'numeric',
            month: 'short'
        });
    }
}
document.getElementById('new-chat-btn').addEventListener('click', function() {
    const messages = document.querySelectorAll('.message-wrapper');
    
    // Hanya simpan ke riwayat jika ada percakapan
    if (messages.length > 0) {
        saveChatToHistory();
    }
    
    // Reset chat
    clearChat();
    currentChatIndex = null;
    
    // Perbarui tampilan
    const noChatMessage = document.getElementById('no-chat-message');
    if (noChatMessage) noChatMessage.style.display = 'block';
});

function checkEmptyChat() {
    const messages = document.querySelectorAll('.message-wrapper');
    const noChatMessage = document.getElementById('no-chat-message');
    
    if (messages.length === 0 && noChatMessage) {
        noChatMessage.style.display = 'block';
    } else if (noChatMessage) {
        noChatMessage.style.display = 'none';
    }
}

// Fungsi untuk mengecek apakah masih ada chat dalam daftar
function checkChatList() {
    const noChatMessage = document.getElementById('no-chat-message');
    const chatList = document.getElementById('chat-list');

    if (chatList.children.length === 0) {
        noChatMessage.style.display = 'block';
    }
}
function checkChatHistory() {
    const noChatMessage = document.getElementById('no-chat-message');
    const chatList = document.getElementById('chat-list');
    
    if (chatList.children.length === 0) {
        noChatMessage.style.display = 'block';
    } else {
        noChatMessage.style.display = 'none';
    }
}
// Cek status saat halaman dimuat
document.addEventListener("DOMContentLoaded", checkChatList);


// **Fungsi Memuat Chat Lama dengan Efek Transisi**
function loadChat(chatId) {
    // Jika ada perubahan yang belum disimpan di chat saat ini, simpan dulu
    if (currentChatId && hasUnsavedChanges(currentChatId)) {
        saveChatToHistory();
    }
    
    const chat = chatHistory.find(c => c.id === chatId);
    if (!chat) return;

    currentChatId = chatId;
    clearChat();
    
    // Load messages from history
    chat.messages.forEach(msg => {
        if (msg.imageUrl) {
            // Jika pesan mengandung gambar
            const messageId = appendMessage(msg.content || "Gambar yang diunggah", msg.isUser);
            const messageWrapper = document.getElementById(messageId);
            const messageDiv = messageWrapper.querySelector('.message');
            
            const imageElement = document.createElement('img');
            imageElement.src = msg.imageUrl;
            imageElement.className = 'uploaded-image';
            imageElement.alt = 'Gambar yang diunggah';
            
            // Sisipkan gambar sebelum teks
            messageDiv.insertBefore(imageElement, messageDiv.firstChild);
        } else {
            // Pesan teks biasa
            appendMessage(msg.content, msg.isUser);
        }
    });
    
    // Sembunyikan welcome message
    document.querySelector('.welcome-message').style.display = 'none';
    document.querySelector('.question-suggestions').style.display = 'none';
    
    // Perbarui tampilan riwayat chat
    renderChatHistory();
}

function createNewChat() {
    // Simpan perubahan chat sebelumnya
    if (currentChatId !== null) {
        saveChatToHistory();
    }
    
    // Reset state
    currentChatId = null;
    conversationHistory = [];
    clearChat();
    
    // Tampilkan elemen awal
    document.querySelector('.welcome-message').style.display = 'block';
    document.querySelector('.question-suggestions').style.display = 'flex';
}

// **Fungsi Menampilkan Modal Konfirmasi Hapus**
function showDeleteModal(index) {
    chatToDelete = index;
    deleteModal.classList.add("show");
}

// **Fungsi Menghapus Chat Setelah Konfirmasi**
confirmDeleteBtn.addEventListener('click', () => {
    if (chatToDelete !== null) {
        chatHistory.splice(chatToDelete, 1);
        localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
        renderChatHistory();
        deleteModal.classList.remove("show");
        chatToDelete = null;
    }
});

// **Fungsi Membatalkan Penghapusan**
cancelDeleteBtn.addEventListener('click', () => {
    deleteModal.classList.remove("show");
    chatToDelete = null;
});

// **Fungsi Membuat Chat Baru**
newChatBtn.addEventListener('click', () => {
    saveChatToHistory();
    clearChat();
    currentChatIndex = null;
});
function deleteChat(chatId) {
    chatHistory = chatHistory.filter(chat => chat.id !== chatId);
    localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
    renderChatHistory();
    
    if (currentChatId === chatId) {
        createNewChat();
    }
}
// **Render Riwayat Chat Saat Halaman Dimuat**
document.addEventListener('DOMContentLoaded', renderChatHistory);
function deleteMessage(messageId) {
    const messageWrapper = document.getElementById(messageId);
    if (!messageWrapper) return;

    const nextMessage = messageWrapper.nextElementSibling;

    // Tambahkan efek animasi sebelum menghapus elemen
    messageWrapper.style.transition = "opacity 0.3s ease, transform 0.3s ease";
    messageWrapper.style.opacity = "0";
    messageWrapper.style.transform = "translateY(-10px) scale(0.9)";

    setTimeout(() => {
        // Jika pesan yang dihapus adalah dari pengguna, hapus juga jawaban AI setelahnya
        if (messageWrapper.classList.contains('user-message-wrapper') && 
            nextMessage && nextMessage.classList.contains('assistant-message-wrapper')) {
            nextMessage.style.transition = "opacity 0.3s ease, transform 0.3s ease";
            nextMessage.style.opacity = "0";
            nextMessage.style.transform = "translateY(-10px) scale(0.9)";
            setTimeout(() => nextMessage.remove(), 300);
        }

        messageWrapper.remove();
        checkEmptyChat(); // Cek apakah chat kosong
    }, 300); // Waktu sesuai dengan durasi animasi
}

document.getElementById('clear-chat-btn').addEventListener('click', function() {
    clearChat();
    showToast('Semua riwayat chat telah dihapus!');
});

// Fungsi untuk menghapus semua chat
function clearChat() {
    const chatContainer = document.getElementById('chat-container');
    chatContainer.innerHTML = `
        <div class="welcome-message">
            <h2>Welcome to Lexxcy AI Assistant!</h2>            <p>I'm here to help with information, answer questions, generate creative content, and assist with various tasks. Just type your message below to get started!</p>
        </div>
        <div class="question-suggestions" id="question-suggestions">
    <button onclick="fillAndSend('Apa itu AI?')">Apa itu AI?</button>
    <button onclick="fillAndSend('Bagaimana cara kerja AI?')">Bagaimana cara kerja AI?</button>
    <button onclick="fillAndSend('Apa manfaat AI dalam kehidupan sehari-hari?')">Apa manfaat AI dalam kehidupan sehari-hari?</button>
    <button onclick="fillAndSend('Bagaimana AI belajar dari data?')">Bagaimana AI belajar dari data?</button>
</div>
    </div>

        </div>
    `;
    
    conversationHistory = [];
    checkEmptyChat(); // Panggil pengecekan chat kosong
}
document.addEventListener("DOMContentLoaded", () => {
    checkEmptyChat();
    // Panggil ini setiap ada perubahan chat
    new MutationObserver(checkEmptyChat).observe(
        document.getElementById('chat-container'), 
        { childList: true }
    );
});

document.getElementById('clear-chat-btn').addEventListener('click', function() {
    clearChat();
});

document.addEventListener("DOMContentLoaded", () => {
    const newChatBtn = document.getElementById("new-chat-btn");
    const chatContainer = document.getElementById("chat-container");
    const noChatMessage = document.createElement("div");

    // Buat elemen untuk menampilkan pesan jika tidak ada chat
    noChatMessage.id = "no-chat-message";
    noChatMessage.className = "welcome-message";
    noChatMessage.innerHTML = "<p>Anda belum membuat chat sama sekali.</p>";
    chatContainer.appendChild(noChatMessage);



    newChatBtn.addEventListener("click", () => {
        const hasMessages = chatContainer.querySelector(".user-message") && chatContainer.querySelector(".assistant-message");

        if (!hasMessages) {
            alert("Anda harus memiliki setidaknya satu pertanyaan dan jawaban sebelum membuat chat baru.");
            return;
        }

        // Hapus chat lama dan tampilkan pesan default
        chatContainer.innerHTML = "";
        chatContainer.appendChild(noChatMessage);
        checkChatHistory();
    });

    checkChatHistory(); // Cek status tombol dan pesan saat halaman dimuat

    // Tambahkan pemantauan ketika ada pesan baru
    const observer = new MutationObserver(checkChatHistory);
    observer.observe(chatContainer, { childList: true, subtree: true });
});


function addCopyButtons() {
    document.querySelectorAll("pre code").forEach((block) => {
        const button = document.createElement("button");
        button.className = "copy-button";
        button.innerHTML = '<i class="fas fa-copy"></i> Copy';
        block.parentNode.style.position = "relative";
        block.parentNode.appendChild(button);

        button.addEventListener("click", () => {
            navigator.clipboard.writeText(block.innerText).then(() => {
                alert("Kode disalin!");
            });
        });
    });
}

document.addEventListener("DOMContentLoaded", addCopyButtons);

document.addEventListener("scroll", function () {
    const sidebar = document.getElementById("sidebar");
    if (sidebar.classList.contains("show")) {
        sidebar.classList.remove("show");
    }
});

// Fungsi untuk menyimpan chat saat ini
function saveCurrentChat() {
    const messages = Array.from(document.querySelectorAll('.message-wrapper')).map(msg => ({
        content: msg.querySelector('.message').textContent.trim(),
        isUser: msg.classList.contains('user-message-wrapper'),
        timestamp: msg.querySelector('.chat-timestamp')?.textContent || new Date().toLocaleTimeString()
    }));

    if (messages.length === 0) return;

    // Jika ada chat aktif, update yang ada
    if (currentChatId) {
        const index = chatHistory.findIndex(chat => chat.id === currentChatId);
        if (index !== -1) {
            chatHistory[index].messages = messages;
            chatHistory[index].lastUpdated = new Date().toISOString();
            localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
            return;
        }
    }

    // Jika tidak ada chat aktif, buat yang baru
    const chatTitle = messages[0].content.substring(0, 20) + (messages[0].content.length > 20 ? "..." : "");
    const newChat = {
        id: Date.now().toString(),
        title: chatTitle,
        messages: messages,
        created: new Date().toISOString(),
        lastUpdated: new Date().toISOString()
    };
    
    chatHistory.unshift(newChat);
    localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
    currentChatId = newChat.id;
}
// Fungsi untuk mendeteksi apakah ada pesan baru yang belum disimpan
function hasUnsavedChanges(chatId) {
    const chat = chatHistory.find(c => c.id === chatId);
    if (!chat) return false;
    
    const currentMessages = Array.from(document.querySelectorAll('.message-wrapper')).map(msg => {
        const messageDiv = msg.querySelector('.message');
        let content = '';
        let imageUrl = '';
        
        const img = messageDiv.querySelector('img');
        if (img) {
            imageUrl = img.src;
            content = messageDiv.textContent.trim();
        } else {
            content = messageDiv.textContent.trim();
        }
        
        return {
            content: content,
            isUser: msg.classList.contains('user-message-wrapper'),
            imageUrl: imageUrl
        };
    });
    
    return JSON.stringify(currentMessages) !== JSON.stringify(chat.messages);
}
 	</script>
</body>
</html>